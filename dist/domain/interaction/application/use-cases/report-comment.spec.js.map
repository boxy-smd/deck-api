{"version":3,"sources":["../../../../../src/domain/interaction/application/use-cases/report-comment.spec.ts"],"sourcesContent":["import type { UsersRepository } from '@/domain/authentication/application/repositories/users-repository'\nimport type { User } from '@/domain/authentication/enterprise/entities/user'\nimport type { CommentsRepository } from '@/domain/interaction/application/repositories/comments-repository'\nimport type { ReportsRepository } from '@/domain/interaction/application/repositories/reports-repository'\nimport type { ProjectsRepository } from '@/domain/projects/application/repositories/projects-repository'\nimport type { Project } from '@/domain/projects/enterprise/entities/project'\nimport { ForbiddenError } from '@/shared/errors/forbidden.error'\nimport { ResourceNotFoundError } from '@/shared/errors/resource-not-found.error'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryCommentsRepository } from 'test/repositories/comments-repository'\nimport { InMemoryProjectsRepository } from 'test/repositories/projects-repository'\nimport { InMemoryReportsRepository } from 'test/repositories/reports-repository'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport type { Comment } from '../../enterprise/entities/comment'\nimport { ReportCommentUseCase } from './report-comment'\n\nlet studentsRepository: UsersRepository\nlet projectsRepository: ProjectsRepository\nlet commentsRepository: CommentsRepository\nlet reportsRepository: ReportsRepository\n\nlet author: User\nlet project: Project\nlet comment: Comment\n\nlet sut: ReportCommentUseCase\n\ndescribe('report comment use case', () => {\n  beforeEach(async () => {\n    studentsRepository = new InMemoryUsersRepository()\n    projectsRepository = new InMemoryProjectsRepository()\n    commentsRepository = new InMemoryCommentsRepository(studentsRepository)\n    reportsRepository = new InMemoryReportsRepository()\n\n    author = await makeUser()\n    project = makeProject()\n    comment = project.comment('Teste', author.id)\n\n    await studentsRepository.create(author)\n    await projectsRepository.create(project)\n    await commentsRepository.create(comment)\n\n    sut = new ReportCommentUseCase(studentsRepository, commentsRepository, reportsRepository)\n  })\n\n  it('should be able to report a comment', async () => {\n    const result = await sut.execute({\n      content: 'This comment is inappropriate.',\n      authorId: author.id.toString(),\n      projectId: project.id.toString(),\n      commentId: comment.id.toString(),\n    })\n    \n    expect(result.isRight()).toBe(true)\n  })\n\n  it('should not be able to report a comment with an invalid author', async () => {\n    const result = await sut.execute({\n      content: 'This comment is inappropriate.',\n      authorId: '',\n      projectId: project.id.toString(),\n      commentId: comment.id.toString(),\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(ForbiddenError)\n  })\n\n  it('should not be able to report a comment with an invalid comment id', async () => {\n    const result = await sut.execute({\n      content: 'This comment is inappropriate.',\n      authorId: '123',\n      projectId: project.id.toString(),\n      commentId: 'invalid-id',\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(ResourceNotFoundError)\n  })\n})\n"],"names":["studentsRepository","projectsRepository","commentsRepository","reportsRepository","author","project","comment","sut","describe","beforeEach","InMemoryUsersRepository","InMemoryProjectsRepository","InMemoryCommentsRepository","InMemoryReportsRepository","makeUser","makeProject","id","create","ReportCommentUseCase","it","result","execute","content","authorId","toString","projectId","commentId","expect","isRight","toBe","isLeft","value","toBeInstanceOf","ForbiddenError","ResourceNotFoundError"],"mappings":";;;;gCAM+B;uCACO;6BACV;0BACH;oCACkB;oCACA;mCACD;iCACF;+BAEH;AAErC,IAAIA;AACJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AAEJC,SAAS,2BAA2B;IAClCC,WAAW;QACTT,qBAAqB,IAAIU,wCAAuB;QAChDT,qBAAqB,IAAIU,8CAA0B;QACnDT,qBAAqB,IAAIU,8CAA0B,CAACZ;QACpDG,oBAAoB,IAAIU,4CAAyB;QAEjDT,SAAS,MAAMU,IAAAA,kBAAQ;QACvBT,UAAUU,IAAAA,wBAAW;QACrBT,UAAUD,QAAQC,OAAO,CAAC,SAASF,OAAOY,EAAE;QAE5C,MAAMhB,mBAAmBiB,MAAM,CAACb;QAChC,MAAMH,mBAAmBgB,MAAM,CAACZ;QAChC,MAAMH,mBAAmBe,MAAM,CAACX;QAEhCC,MAAM,IAAIW,mCAAoB,CAAClB,oBAAoBE,oBAAoBC;IACzE;IAEAgB,GAAG,sCAAsC;QACvC,MAAMC,SAAS,MAAMb,IAAIc,OAAO,CAAC;YAC/BC,SAAS;YACTC,UAAUnB,OAAOY,EAAE,CAACQ,QAAQ;YAC5BC,WAAWpB,QAAQW,EAAE,CAACQ,QAAQ;YAC9BE,WAAWpB,QAAQU,EAAE,CAACQ,QAAQ;QAChC;QAEAG,OAAOP,OAAOQ,OAAO,IAAIC,IAAI,CAAC;IAChC;IAEAV,GAAG,iEAAiE;QAClE,MAAMC,SAAS,MAAMb,IAAIc,OAAO,CAAC;YAC/BC,SAAS;YACTC,UAAU;YACVE,WAAWpB,QAAQW,EAAE,CAACQ,QAAQ;YAC9BE,WAAWpB,QAAQU,EAAE,CAACQ,QAAQ;QAChC;QAEAG,OAAOP,OAAOU,MAAM,IAAID,IAAI,CAAC;QAC7BF,OAAOP,OAAOW,KAAK,EAAEC,cAAc,CAACC,8BAAc;IACpD;IAEAd,GAAG,qEAAqE;QACtE,MAAMC,SAAS,MAAMb,IAAIc,OAAO,CAAC;YAC/BC,SAAS;YACTC,UAAU;YACVE,WAAWpB,QAAQW,EAAE,CAACQ,QAAQ;YAC9BE,WAAW;QACb;QAEAC,OAAOP,OAAOU,MAAM,IAAID,IAAI,CAAC;QAC7BF,OAAOP,OAAOW,KAAK,EAAEC,cAAc,CAACE,4CAAqB;IAC3D;AACF"}