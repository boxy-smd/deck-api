{"version":3,"sources":["../../../../../src/domain/authentication/application/use-cases/login.spec.ts"],"sourcesContent":["import { InvalidCredentialsError } from '@/shared/errors/invalid-credentials.error'\nimport { FakeHasher } from 'test/cryptography/fake-hasher'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport type { User } from '../../enterprise/entities/user'\nimport type { UsersRepository } from '../repositories/users-repository'\nimport { LoginUseCase } from './login'\n\nlet usersRepository: UsersRepository\nlet hasher: FakeHasher\n\nlet user: User\n\nlet sut: LoginUseCase\n\ndescribe('login use case', () => {\n  beforeEach(async () => {\n    usersRepository = new InMemoryUsersRepository()\n    hasher = new FakeHasher()\n\n    user = await makeUser()\n\n    await usersRepository.create(user)\n\n    sut = new LoginUseCase(usersRepository, hasher)\n  })\n\n  it('should be able to login a user', async () => {\n    const result = await sut.execute({\n      email: user.email.value,\n      password: '123456',\n    })\n\n    expect(result.isRight()).toBe(true)\n    expect(result.isRight() && result.value).toMatchObject({\n      id: user.id.toString(),\n    })\n  })\n\n  it('should not be able to login an unregistered user', async () => {\n    const result = await sut.execute({\n      email: 'janedoe@alu.ufc.br',\n      password: '123456',\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(InvalidCredentialsError)\n  })\n\n  it('should not be able to login a user with wrong password', async () => {\n    await usersRepository.create(user)\n\n    const result = await sut.execute({\n      email: user.email.value,\n      password: '654321',\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(InvalidCredentialsError)\n  })\n})\n"],"names":["usersRepository","hasher","user","sut","describe","beforeEach","InMemoryUsersRepository","FakeHasher","makeUser","create","LoginUseCase","it","result","execute","email","value","password","expect","isRight","toBe","toMatchObject","id","toString","isLeft","toBeInstanceOf","InvalidCredentialsError"],"mappings":";;;;yCAAwC;4BACb;0BACF;iCACe;uBAGX;AAE7B,IAAIA;AACJ,IAAIC;AAEJ,IAAIC;AAEJ,IAAIC;AAEJC,SAAS,kBAAkB;IACzBC,WAAW;QACTL,kBAAkB,IAAIM,wCAAuB;QAC7CL,SAAS,IAAIM,sBAAU;QAEvBL,OAAO,MAAMM,IAAAA,kBAAQ;QAErB,MAAMR,gBAAgBS,MAAM,CAACP;QAE7BC,MAAM,IAAIO,mBAAY,CAACV,iBAAiBC;IAC1C;IAEAU,GAAG,kCAAkC;QACnC,MAAMC,SAAS,MAAMT,IAAIU,OAAO,CAAC;YAC/BC,OAAOZ,KAAKY,KAAK,CAACC,KAAK;YACvBC,UAAU;QACZ;QAEAC,OAAOL,OAAOM,OAAO,IAAIC,IAAI,CAAC;QAC9BF,OAAOL,OAAOM,OAAO,MAAMN,OAAOG,KAAK,EAAEK,aAAa,CAAC;YACrDC,IAAInB,KAAKmB,EAAE,CAACC,QAAQ;QACtB;IACF;IAEAX,GAAG,oDAAoD;QACrD,MAAMC,SAAS,MAAMT,IAAIU,OAAO,CAAC;YAC/BC,OAAO;YACPE,UAAU;QACZ;QAEAC,OAAOL,OAAOW,MAAM,IAAIJ,IAAI,CAAC;QAC7BF,OAAOL,OAAOG,KAAK,EAAES,cAAc,CAACC,gDAAuB;IAC7D;IAEAd,GAAG,0DAA0D;QAC3D,MAAMX,gBAAgBS,MAAM,CAACP;QAE7B,MAAMU,SAAS,MAAMT,IAAIU,OAAO,CAAC;YAC/BC,OAAOZ,KAAKY,KAAK,CAACC,KAAK;YACvBC,UAAU;QACZ;QAEAC,OAAOL,OAAOW,MAAM,IAAIJ,IAAI,CAAC;QAC7BF,OAAOL,OAAOG,KAAK,EAAES,cAAc,CAACC,gDAAuB;IAC7D;AACF"}