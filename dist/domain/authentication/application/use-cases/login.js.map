{"version":3,"sources":["../../../../../src/domain/authentication/application/use-cases/login.ts"],"sourcesContent":["import { type Either, left, right } from '@/shared/either'\nimport { InvalidCredentialsError } from '@/shared/errors/invalid-credentials.error'\nimport type { HashComparer } from '../cryptography/hash-comparer'\nimport type { UsersRepository } from '../repositories/users-repository'\n\ninterface LoginUseCaseRequest {\n  email: string\n  password: string\n}\n\ntype LoginUseCaseResponse = Either<\n  InvalidCredentialsError,\n  {\n    id: string\n  }\n>\n\nexport class LoginUseCase {\n  constructor(\n    private usersRepository: UsersRepository,\n    private hashComparer: HashComparer,\n  ) {}\n\n  public async execute({\n    email,\n    password,\n  }: LoginUseCaseRequest): Promise<LoginUseCaseResponse> {\n    const user = await this.usersRepository.findByEmail(email)\n\n    if (!user) {\n      return left(new InvalidCredentialsError())\n    }\n\n    const isPasswordValid = await this.hashComparer.compare(\n      password,\n      user.passwordHash,\n    )\n\n    if (!isPasswordValid) {\n      return left(new InvalidCredentialsError())\n    }\n\n    return right({\n      id: user.id.toString(),\n    })\n  }\n}\n"],"names":["LoginUseCase","execute","email","password","user","usersRepository","findByEmail","left","InvalidCredentialsError","isPasswordValid","hashComparer","compare","passwordHash","right","id","toString"],"mappings":";;;;+BAiBaA;;;eAAAA;;;wBAjB4B;yCACD;AAgBjC,IAAA,AAAMA,eAAN,MAAMA;IAMX,MAAaC,QAAQ,EACnBC,KAAK,EACLC,QAAQ,EACY,EAAiC;QACrD,MAAMC,OAAO,MAAM,IAAI,CAACC,eAAe,CAACC,WAAW,CAACJ;QAEpD,IAAI,CAACE,MAAM;YACT,OAAOG,IAAAA,YAAI,EAAC,IAAIC,gDAAuB;QACzC;QAEA,MAAMC,kBAAkB,MAAM,IAAI,CAACC,YAAY,CAACC,OAAO,CACrDR,UACAC,KAAKQ,YAAY;QAGnB,IAAI,CAACH,iBAAiB;YACpB,OAAOF,IAAAA,YAAI,EAAC,IAAIC,gDAAuB;QACzC;QAEA,OAAOK,IAAAA,aAAK,EAAC;YACXC,IAAIV,KAAKU,EAAE,CAACC,QAAQ;QACtB;IACF;IA3BA,YACE,AAAQV,eAAgC,EACxC,AAAQK,YAA0B,CAClC;aAFQL,kBAAAA;aACAK,eAAAA;IACP;AAyBL"}