{"version":3,"sources":["../../../../../src/domain/authentication/application/use-cases/register.spec.ts"],"sourcesContent":["import { ResourceAlreadyExistsError } from '@/shared/errors/resource-already-exists.error'\nimport { FakeHasher } from 'test/cryptography/fake-hasher'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryTrailsRepository } from 'test/repositories/trails-repository'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport { User } from '../../enterprise/entities/user'\nimport { RegisterUseCase } from './register'\n\nlet usersRepository: InMemoryUsersRepository\nlet trailsRepository: InMemoryTrailsRepository\nlet hasher: FakeHasher\n\nlet user: User\n\nlet sut: RegisterUseCase\n\ndescribe('register use case', () => {\n  beforeEach(async () => {\n    usersRepository = new InMemoryUsersRepository()\n    trailsRepository = new InMemoryTrailsRepository()\n    hasher = new FakeHasher()\n\n    user = await makeUser()\n\n    sut = new RegisterUseCase(usersRepository, trailsRepository, hasher)\n  })\n\n  it('should be able to register a user', async () => {\n    const result = await sut.execute({\n      name: 'John Doe',\n      username: 'johndoe',\n      email: 'johndoe@alu.ufc.br',\n      password: '123456',\n      semester: 1,\n      trailsIds: [],\n    })\n\n    expect(result.isRight()).toBe(true)\n    expect(result.value).toBeInstanceOf(User)\n  })\n\n  it('should not be able to register a user with an existing email', async () => {\n    await usersRepository.create(user)\n\n    const result = await sut.execute({\n      name: 'John Doe',\n      username: 'johndoe',\n      email: user.email.value,\n      password: '123456',\n      semester: 1,\n      trailsIds: [],\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(ResourceAlreadyExistsError)\n  })\n\n  it('should not be able to register a user with an existing username', async () => {\n    await usersRepository.create(user)\n\n    const result = await sut.execute({\n      name: 'John Doe',\n      username: user.username.value,\n      email: 'johndoe@alu.ufc.br',\n      password: '123456',\n      semester: 1,\n      trailsIds: [],\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(ResourceAlreadyExistsError)\n  })\n})\n"],"names":["usersRepository","trailsRepository","hasher","user","sut","describe","beforeEach","InMemoryUsersRepository","InMemoryTrailsRepository","FakeHasher","makeUser","RegisterUseCase","it","result","execute","name","username","email","password","semester","trailsIds","expect","isRight","toBe","value","toBeInstanceOf","User","create","isLeft","ResourceAlreadyExistsError"],"mappings":";;;;4CAA2C;4BAChB;0BACF;kCACgB;iCACD;sBACnB;0BACW;AAEhC,IAAIA;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AAEJ,IAAIC;AAEJC,SAAS,qBAAqB;IAC5BC,WAAW;QACTN,kBAAkB,IAAIO,wCAAuB;QAC7CN,mBAAmB,IAAIO,0CAAwB;QAC/CN,SAAS,IAAIO,sBAAU;QAEvBN,OAAO,MAAMO,IAAAA,kBAAQ;QAErBN,MAAM,IAAIO,yBAAe,CAACX,iBAAiBC,kBAAkBC;IAC/D;IAEAU,GAAG,qCAAqC;QACtC,MAAMC,SAAS,MAAMT,IAAIU,OAAO,CAAC;YAC/BC,MAAM;YACNC,UAAU;YACVC,OAAO;YACPC,UAAU;YACVC,UAAU;YACVC,WAAW,EAAE;QACf;QAEAC,OAAOR,OAAOS,OAAO,IAAIC,IAAI,CAAC;QAC9BF,OAAOR,OAAOW,KAAK,EAAEC,cAAc,CAACC,UAAI;IAC1C;IAEAd,GAAG,gEAAgE;QACjE,MAAMZ,gBAAgB2B,MAAM,CAACxB;QAE7B,MAAMU,SAAS,MAAMT,IAAIU,OAAO,CAAC;YAC/BC,MAAM;YACNC,UAAU;YACVC,OAAOd,KAAKc,KAAK,CAACO,KAAK;YACvBN,UAAU;YACVC,UAAU;YACVC,WAAW,EAAE;QACf;QAEAC,OAAOR,OAAOe,MAAM,IAAIL,IAAI,CAAC;QAC7BF,OAAOR,OAAOW,KAAK,EAAEC,cAAc,CAACI,sDAA0B;IAChE;IAEAjB,GAAG,mEAAmE;QACpE,MAAMZ,gBAAgB2B,MAAM,CAACxB;QAE7B,MAAMU,SAAS,MAAMT,IAAIU,OAAO,CAAC;YAC/BC,MAAM;YACNC,UAAUb,KAAKa,QAAQ,CAACQ,KAAK;YAC7BP,OAAO;YACPC,UAAU;YACVC,UAAU;YACVC,WAAW,EAAE;QACf;QAEAC,OAAOR,OAAOe,MAAM,IAAIL,IAAI,CAAC;QAC7BF,OAAOR,OAAOW,KAAK,EAAEC,cAAc,CAACI,sDAA0B;IAChE;AACF"}