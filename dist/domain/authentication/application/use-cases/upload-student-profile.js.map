{"version":3,"sources":["../../../../../src/domain/authentication/application/use-cases/upload-student-profile.ts"],"sourcesContent":["import type { UsersRepository } from '@/domain/authentication/application/repositories/users-repository'\nimport { type Either, left, right } from '@/shared/either'\nimport { ResourceNotFoundError } from '@/shared/errors/resource-not-found.error'\nimport type { StorageUploader } from '../storage/uploader'\n\ninterface UploadStudentProfileUseCaseRequest {\n  username: string\n  filename: string\n  image: Buffer\n}\n\ntype UploadStudentProfileUseCaseResponse = Either<ResourceNotFoundError, void>\n\nexport class UploadStudentProfileUseCase {\n  constructor(\n    private readonly studentsRepository: UsersRepository,\n    private readonly profilesUploader: StorageUploader,\n  ) {}\n\n  async execute({\n    filename,\n    image,\n    username,\n  }: UploadStudentProfileUseCaseRequest): Promise<UploadStudentProfileUseCaseResponse> {\n    const student = await this.studentsRepository.findByUsername(username)\n\n    if (!student) {\n      return left(new ResourceNotFoundError('Student not found.'))\n    }\n\n    const { downloadUrl } = await this.profilesUploader.upload(image, filename)\n\n    student.changeProfilePicture(downloadUrl)\n\n    await this.studentsRepository.save(student)\n\n    return right(undefined)\n  }\n}\n"],"names":["UploadStudentProfileUseCase","execute","filename","image","username","student","studentsRepository","findByUsername","left","ResourceNotFoundError","downloadUrl","profilesUploader","upload","changeProfilePicture","save","right","undefined"],"mappings":";;;;+BAaaA;;;eAAAA;;;wBAZ4B;uCACH;AAW/B,IAAA,AAAMA,8BAAN,MAAMA;IAMX,MAAMC,QAAQ,EACZC,QAAQ,EACRC,KAAK,EACLC,QAAQ,EAC2B,EAAgD;QACnF,MAAMC,UAAU,MAAM,IAAI,CAACC,kBAAkB,CAACC,cAAc,CAACH;QAE7D,IAAI,CAACC,SAAS;YACZ,OAAOG,IAAAA,YAAI,EAAC,IAAIC,4CAAqB,CAAC;QACxC;QAEA,MAAM,EAAEC,WAAW,EAAE,GAAG,MAAM,IAAI,CAACC,gBAAgB,CAACC,MAAM,CAACT,OAAOD;QAElEG,QAAQQ,oBAAoB,CAACH;QAE7B,MAAM,IAAI,CAACJ,kBAAkB,CAACQ,IAAI,CAACT;QAEnC,OAAOU,IAAAA,aAAK,EAACC;IACf;IAvBA,YACE,AAAiBV,kBAAmC,EACpD,AAAiBK,gBAAiC,CAClD;aAFiBL,qBAAAA;aACAK,mBAAAA;IAChB;AAqBL"}