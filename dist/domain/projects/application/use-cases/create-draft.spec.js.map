{"version":3,"sources":["../../../../../src/domain/projects/application/use-cases/create-draft.spec.ts"],"sourcesContent":["import type { UsersRepository } from '@/domain/authentication/application/repositories/users-repository'\nimport type { User } from '@/domain/authentication/enterprise/entities/user'\nimport { ForbiddenError } from '@/shared/errors/forbidden.error'\nimport { ResourceNotFoundError } from '@/shared/errors/resource-not-found.error'\nimport { makeTrail } from 'test/factories/make-trail'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryProfessorsRepository } from 'test/repositories/professors-repository'\nimport { InMemoryProjectsRepository } from 'test/repositories/projects-repository'\nimport { InMemorySubjectsRepository } from 'test/repositories/subjects-repository'\nimport { InMemoryTrailsRepository } from 'test/repositories/trails-repository'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport type { Trail } from '../../enterprise/entities/trail'\nimport type { ProfessorsRepository } from '../repositories/professors-repository'\nimport type { ProjectsRepository } from '../repositories/projects-repository'\nimport type { SubjectsRepository } from '../repositories/subjects-repository'\nimport type { TrailsRepository } from '../repositories/trails-repository'\nimport { CreateDraftUseCase } from './create-draft'\n\nlet projectsRepository: ProjectsRepository\nlet usersRepository: UsersRepository\nlet subjectsRepository: SubjectsRepository\nlet trailsRepository: TrailsRepository\nlet professorsRepository: ProfessorsRepository\n\nlet author: User\nlet trail: Trail\n\nlet sut: CreateDraftUseCase\n\ndescribe('create draft use case', () => {\n  beforeEach(async () => {\n    projectsRepository = new InMemoryProjectsRepository()\n    usersRepository = new InMemoryUsersRepository()\n    subjectsRepository = new InMemorySubjectsRepository()\n    trailsRepository = new InMemoryTrailsRepository()\n    professorsRepository = new InMemoryProfessorsRepository()\n\n    author = await makeUser()\n    trail = makeTrail()\n\n    sut = new CreateDraftUseCase(\n      projectsRepository,\n      usersRepository,\n      subjectsRepository,\n      trailsRepository,\n      professorsRepository,\n    )\n  })\n\n  it('should be able to create a draft', async () => {\n    await usersRepository.create(author)\n    await trailsRepository.create(trail)\n\n    const result = await sut.execute({\n      title: 'Título do rascunho',\n      authorId: author.id.toString(),\n    })\n\n    expect(result.isRight()).toBe(true)\n    expect(result.value).toMatchObject({\n      draftId: expect.any(String),\n    })\n  })\n\n  it('should not be able to create a draft without a title', async () => {\n    await usersRepository.create(author)\n\n    const result = await sut.execute({\n      title: '',\n      authorId: author.id.toString(),\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(ForbiddenError)\n  })\n\n  it('should not be able to create a draft with an invalid author', async () => {\n    await trailsRepository.create(trail)\n\n    const result = await sut.execute({\n      title: 'Título do rascunho',\n      authorId: 'invalid-author-id',\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(ResourceNotFoundError)\n  })\n\n  it('should not be able to create a draft with an invalid trail', async () => {\n    await usersRepository.create(author)\n\n    const result = await sut.execute({\n      title: 'Título do rascunho',\n      authorId: author.id.toString(),\n      trailsIds: ['invalid-trail-id'],\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.value).toBeInstanceOf(ResourceNotFoundError)\n  })\n})\n"],"names":["projectsRepository","usersRepository","subjectsRepository","trailsRepository","professorsRepository","author","trail","sut","describe","beforeEach","InMemoryProjectsRepository","InMemoryUsersRepository","InMemorySubjectsRepository","InMemoryTrailsRepository","InMemoryProfessorsRepository","makeUser","makeTrail","CreateDraftUseCase","it","create","result","execute","title","authorId","id","toString","expect","isRight","toBe","value","toMatchObject","draftId","any","String","isLeft","toBeInstanceOf","ForbiddenError","ResourceNotFoundError","trailsIds"],"mappings":";;;;gCAE+B;uCACO;2BACZ;0BACD;sCACoB;oCACF;oCACA;kCACF;iCACD;6BAML;AAEnC,IAAIA;AACJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AAEJC,SAAS,yBAAyB;IAChCC,WAAW;QACTT,qBAAqB,IAAIU,8CAA0B;QACnDT,kBAAkB,IAAIU,wCAAuB;QAC7CT,qBAAqB,IAAIU,8CAA0B;QACnDT,mBAAmB,IAAIU,0CAAwB;QAC/CT,uBAAuB,IAAIU,kDAA4B;QAEvDT,SAAS,MAAMU,IAAAA,kBAAQ;QACvBT,QAAQU,IAAAA,oBAAS;QAEjBT,MAAM,IAAIU,+BAAkB,CAC1BjB,oBACAC,iBACAC,oBACAC,kBACAC;IAEJ;IAEAc,GAAG,oCAAoC;QACrC,MAAMjB,gBAAgBkB,MAAM,CAACd;QAC7B,MAAMF,iBAAiBgB,MAAM,CAACb;QAE9B,MAAMc,SAAS,MAAMb,IAAIc,OAAO,CAAC;YAC/BC,OAAO;YACPC,UAAUlB,OAAOmB,EAAE,CAACC,QAAQ;QAC9B;QAEAC,OAAON,OAAOO,OAAO,IAAIC,IAAI,CAAC;QAC9BF,OAAON,OAAOS,KAAK,EAAEC,aAAa,CAAC;YACjCC,SAASL,OAAOM,GAAG,CAACC;QACtB;IACF;IAEAf,GAAG,wDAAwD;QACzD,MAAMjB,gBAAgBkB,MAAM,CAACd;QAE7B,MAAMe,SAAS,MAAMb,IAAIc,OAAO,CAAC;YAC/BC,OAAO;YACPC,UAAUlB,OAAOmB,EAAE,CAACC,QAAQ;QAC9B;QAEAC,OAAON,OAAOc,MAAM,IAAIN,IAAI,CAAC;QAC7BF,OAAON,OAAOS,KAAK,EAAEM,cAAc,CAACC,8BAAc;IACpD;IAEAlB,GAAG,+DAA+D;QAChE,MAAMf,iBAAiBgB,MAAM,CAACb;QAE9B,MAAMc,SAAS,MAAMb,IAAIc,OAAO,CAAC;YAC/BC,OAAO;YACPC,UAAU;QACZ;QAEAG,OAAON,OAAOc,MAAM,IAAIN,IAAI,CAAC;QAC7BF,OAAON,OAAOS,KAAK,EAAEM,cAAc,CAACE,4CAAqB;IAC3D;IAEAnB,GAAG,8DAA8D;QAC/D,MAAMjB,gBAAgBkB,MAAM,CAACd;QAE7B,MAAMe,SAAS,MAAMb,IAAIc,OAAO,CAAC;YAC/BC,OAAO;YACPC,UAAUlB,OAAOmB,EAAE,CAACC,QAAQ;YAC5Ba,WAAW;gBAAC;aAAmB;QACjC;QAEAZ,OAAON,OAAOc,MAAM,IAAIN,IAAI,CAAC;QAC7BF,OAAON,OAAOS,KAAK,EAAEM,cAAc,CAACE,4CAAqB;IAC3D;AACF"}