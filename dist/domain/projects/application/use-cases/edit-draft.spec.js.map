{"version":3,"sources":["../../../../../src/domain/projects/application/use-cases/edit-draft.spec.ts"],"sourcesContent":["import type { UsersRepository } from '@/domain/authentication/application/repositories/users-repository'\nimport type { User } from '@/domain/authentication/enterprise/entities/user'\nimport type { ProfessorsRepository } from '@/domain/projects/application/repositories/professors-repository'\nimport type { ProjectsRepository } from '@/domain/projects/application/repositories/projects-repository'\nimport type { SubjectsRepository } from '@/domain/projects/application/repositories/subjects-repository'\nimport type { TrailsRepository } from '@/domain/projects/application/repositories/trails-repository'\nimport type { Project } from '@/domain/projects/enterprise/entities/project'\nimport type { Trail } from '@/domain/projects/enterprise/entities/trail'\nimport { ForbiddenError } from '@/shared/errors/forbidden.error'\nimport { ResourceNotFoundError } from '@/shared/errors/resource-not-found.error'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeTrail } from 'test/factories/make-trail'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryProfessorsRepository } from 'test/repositories/professors-repository'\nimport { InMemoryProjectsRepository } from 'test/repositories/projects-repository'\nimport { InMemorySubjectsRepository } from 'test/repositories/subjects-repository'\nimport { InMemoryTrailsRepository } from 'test/repositories/trails-repository'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport { EditDraftUseCase } from './edit-draft'\n\nlet projectsRepository: ProjectsRepository\nlet studentsRepository: UsersRepository\nlet subjectsRepository: SubjectsRepository\nlet trailsRepository: TrailsRepository\nlet professorsRepository: ProfessorsRepository\n\nlet author: User\nlet trail: Trail\nlet draft: Project\n\nlet sut: EditDraftUseCase\n\ndescribe('edit draft use case', () => {\n  beforeEach(async () => {\n    studentsRepository = new InMemoryUsersRepository()\n    subjectsRepository = new InMemorySubjectsRepository()\n    trailsRepository = new InMemoryTrailsRepository()\n    professorsRepository = new InMemoryProfessorsRepository()\n    projectsRepository = new InMemoryProjectsRepository(\n      studentsRepository,\n      subjectsRepository,\n      trailsRepository,\n      professorsRepository,\n    )\n\n    author = await makeUser()\n    trail = makeTrail()\n    draft = makeProject({\n      title: 'Draft Title',\n      authorId: author.id,\n    })\n\n    await studentsRepository.create(author)\n    await trailsRepository.create(trail)\n    await projectsRepository.create(draft)\n\n    sut = new EditDraftUseCase(\n      projectsRepository,\n      studentsRepository,\n      subjectsRepository,\n      trailsRepository,\n      professorsRepository,\n    )\n  })\n\n  it('should be able to edit a draft', async () => {\n    const result = await sut.execute({\n      authorId: author.id.toString(),\n      draftId: draft.id.toString(),\n      title: 'New Draft Title',\n    })\n\n    expect(result.isRight()).toBe(true)\n    expect(result.isRight() && result.value.title).toBe('New Draft Title')\n  })\n\n  it('should not be able to edit a draft without being logged in', async () => {\n    const result = await sut.execute({\n      authorId: '',\n      draftId: draft.id.toString(),\n      title: 'New Draft Title',\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.isLeft() && result.value).toBeInstanceOf(ForbiddenError)\n  })\n\n  it('should not be able to edit a draft that does not exist', async () => {\n    const result = await sut.execute({\n      authorId: author.id.toString(),\n      draftId: 'invalid-id',\n      title: 'New Draft Title',\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.isLeft() && result.value).toBeInstanceOf(\n      ResourceNotFoundError,\n    )\n  })\n\n  it('should not be able to edit a draft from another author', async () => {\n    const anotherAuthor = await makeUser()\n    await studentsRepository.create(anotherAuthor)\n\n    const result = await sut.execute({\n      authorId: anotherAuthor.id.toString(),\n      draftId: draft.id.toString(),\n      title: 'New Draft Title',\n    })\n\n    expect(result.isLeft()).toBe(true)\n    expect(result.isLeft() && result.value).toBeInstanceOf(ForbiddenError)\n  })\n})\n"],"names":["projectsRepository","studentsRepository","subjectsRepository","trailsRepository","professorsRepository","author","trail","draft","sut","describe","beforeEach","InMemoryUsersRepository","InMemorySubjectsRepository","InMemoryTrailsRepository","InMemoryProfessorsRepository","InMemoryProjectsRepository","makeUser","makeTrail","makeProject","title","authorId","id","create","EditDraftUseCase","it","result","execute","toString","draftId","expect","isRight","toBe","value","isLeft","toBeInstanceOf","ForbiddenError","ResourceNotFoundError","anotherAuthor"],"mappings":";;;;gCAQ+B;uCACO;6BACV;2BACF;0BACD;sCACoB;oCACF;oCACA;kCACF;iCACD;2BACP;AAEjC,IAAIA;AACJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AAEJC,SAAS,uBAAuB;IAC9BC,WAAW;QACTT,qBAAqB,IAAIU,wCAAuB;QAChDT,qBAAqB,IAAIU,8CAA0B;QACnDT,mBAAmB,IAAIU,0CAAwB;QAC/CT,uBAAuB,IAAIU,kDAA4B;QACvDd,qBAAqB,IAAIe,8CAA0B,CACjDd,oBACAC,oBACAC,kBACAC;QAGFC,SAAS,MAAMW,IAAAA,kBAAQ;QACvBV,QAAQW,IAAAA,oBAAS;QACjBV,QAAQW,IAAAA,wBAAW,EAAC;YAClBC,OAAO;YACPC,UAAUf,OAAOgB,EAAE;QACrB;QAEA,MAAMpB,mBAAmBqB,MAAM,CAACjB;QAChC,MAAMF,iBAAiBmB,MAAM,CAAChB;QAC9B,MAAMN,mBAAmBsB,MAAM,CAACf;QAEhCC,MAAM,IAAIe,2BAAgB,CACxBvB,oBACAC,oBACAC,oBACAC,kBACAC;IAEJ;IAEAoB,GAAG,kCAAkC;QACnC,MAAMC,SAAS,MAAMjB,IAAIkB,OAAO,CAAC;YAC/BN,UAAUf,OAAOgB,EAAE,CAACM,QAAQ;YAC5BC,SAASrB,MAAMc,EAAE,CAACM,QAAQ;YAC1BR,OAAO;QACT;QAEAU,OAAOJ,OAAOK,OAAO,IAAIC,IAAI,CAAC;QAC9BF,OAAOJ,OAAOK,OAAO,MAAML,OAAOO,KAAK,CAACb,KAAK,EAAEY,IAAI,CAAC;IACtD;IAEAP,GAAG,8DAA8D;QAC/D,MAAMC,SAAS,MAAMjB,IAAIkB,OAAO,CAAC;YAC/BN,UAAU;YACVQ,SAASrB,MAAMc,EAAE,CAACM,QAAQ;YAC1BR,OAAO;QACT;QAEAU,OAAOJ,OAAOQ,MAAM,IAAIF,IAAI,CAAC;QAC7BF,OAAOJ,OAAOQ,MAAM,MAAMR,OAAOO,KAAK,EAAEE,cAAc,CAACC,8BAAc;IACvE;IAEAX,GAAG,0DAA0D;QAC3D,MAAMC,SAAS,MAAMjB,IAAIkB,OAAO,CAAC;YAC/BN,UAAUf,OAAOgB,EAAE,CAACM,QAAQ;YAC5BC,SAAS;YACTT,OAAO;QACT;QAEAU,OAAOJ,OAAOQ,MAAM,IAAIF,IAAI,CAAC;QAC7BF,OAAOJ,OAAOQ,MAAM,MAAMR,OAAOO,KAAK,EAAEE,cAAc,CACpDE,4CAAqB;IAEzB;IAEAZ,GAAG,0DAA0D;QAC3D,MAAMa,gBAAgB,MAAMrB,IAAAA,kBAAQ;QACpC,MAAMf,mBAAmBqB,MAAM,CAACe;QAEhC,MAAMZ,SAAS,MAAMjB,IAAIkB,OAAO,CAAC;YAC/BN,UAAUiB,cAAchB,EAAE,CAACM,QAAQ;YACnCC,SAASrB,MAAMc,EAAE,CAACM,QAAQ;YAC1BR,OAAO;QACT;QAEAU,OAAOJ,OAAOQ,MAAM,IAAIF,IAAI,CAAC;QAC7BF,OAAOJ,OAAOQ,MAAM,MAAMR,OAAOO,KAAK,EAAEE,cAAc,CAACC,8BAAc;IACvE;AACF"}