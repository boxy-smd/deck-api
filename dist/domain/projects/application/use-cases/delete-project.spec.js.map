{"version":3,"sources":["../../../../../src/domain/projects/application/use-cases/delete-project.spec.ts"],"sourcesContent":["import type { UsersRepository } from '@/domain/authentication/application/repositories/users-repository'\nimport type { User } from '@/domain/authentication/enterprise/entities/user'\nimport { ForbiddenError } from '@/shared/errors/forbidden.error'\nimport { ResourceNotFoundError } from '@/shared/errors/resource-not-found.error'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeTrail } from 'test/factories/make-trail'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryProjectsRepository } from 'test/repositories/projects-repository'\nimport { InMemoryTrailsRepository } from 'test/repositories/trails-repository'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport type { Project } from '../../enterprise/entities/project'\nimport type { Trail } from '../../enterprise/entities/trail'\nimport type { ProjectsRepository } from '../repositories/projects-repository'\nimport type { TrailsRepository } from '../repositories/trails-repository'\nimport { DeleteProjectUseCase } from './delete-project'\n\nlet usersRepository: UsersRepository\nlet projectsRepository: ProjectsRepository\nlet trailsRepository: TrailsRepository\n\nlet author: User\nlet trail: Trail\nlet project: Project\n\nlet sut: DeleteProjectUseCase\n\ndescribe('delete project use case', () => {\n  beforeEach(async () => {\n    usersRepository = new InMemoryUsersRepository()\n    trailsRepository = new InMemoryTrailsRepository()\n    projectsRepository = new InMemoryProjectsRepository()\n\n    author = await makeUser()\n    trail = makeTrail()\n    project = makeProject({\n      authorId: author.id,\n      trails: new Set([trail.id]),\n    })\n\n    await usersRepository.save(author)\n    await projectsRepository.save(project)\n    await trailsRepository.save(trail)\n\n    sut = new DeleteProjectUseCase(projectsRepository)\n  })\n\n  it('should be able to delete a project', async () => {\n    const response = await sut.execute({\n      studentId: author.id.toString(),\n      projectId: project.id.toString(),\n    })\n\n    expect(response.isRight()).toBe(true)\n    expect(await projectsRepository.findById(project.id.toString())).toBe(null)\n  })\n\n  it('should not be able to delete a project that does not exist', async () => {\n    const response = await sut.execute({\n      studentId: author.id.toString(),\n      projectId: 'invalid-id',\n    })\n\n    expect(response.isLeft()).toBe(true)\n    expect(response.value).toBeInstanceOf(ResourceNotFoundError)\n  })\n\n  it('should not be able to delete a project that does not belong to the student', async () => {\n    const otherAuthor = await makeUser()\n    await usersRepository.save(otherAuthor)\n\n    const response = await sut.execute({\n      studentId: otherAuthor.id.toString(),\n      projectId: project.id.toString(),\n    })\n\n    expect(response.isLeft()).toBe(true)\n    expect(response.value).toBeInstanceOf(ForbiddenError)\n  })\n})\n"],"names":["usersRepository","projectsRepository","trailsRepository","author","trail","project","sut","describe","beforeEach","InMemoryUsersRepository","InMemoryTrailsRepository","InMemoryProjectsRepository","makeUser","makeTrail","makeProject","authorId","id","trails","Set","save","DeleteProjectUseCase","it","response","execute","studentId","toString","projectId","expect","isRight","toBe","findById","isLeft","value","toBeInstanceOf","ResourceNotFoundError","otherAuthor","ForbiddenError"],"mappings":";;;;gCAE+B;uCACO;6BACV;2BACF;0BACD;oCACkB;kCACF;iCACD;+BAKH;AAErC,IAAIA;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AACJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AAEJC,SAAS,2BAA2B;IAClCC,WAAW;QACTR,kBAAkB,IAAIS,wCAAuB;QAC7CP,mBAAmB,IAAIQ,0CAAwB;QAC/CT,qBAAqB,IAAIU,8CAA0B;QAEnDR,SAAS,MAAMS,IAAAA,kBAAQ;QACvBR,QAAQS,IAAAA,oBAAS;QACjBR,UAAUS,IAAAA,wBAAW,EAAC;YACpBC,UAAUZ,OAAOa,EAAE;YACnBC,QAAQ,IAAIC,IAAI;gBAACd,MAAMY,EAAE;aAAC;QAC5B;QAEA,MAAMhB,gBAAgBmB,IAAI,CAAChB;QAC3B,MAAMF,mBAAmBkB,IAAI,CAACd;QAC9B,MAAMH,iBAAiBiB,IAAI,CAACf;QAE5BE,MAAM,IAAIc,mCAAoB,CAACnB;IACjC;IAEAoB,GAAG,sCAAsC;QACvC,MAAMC,WAAW,MAAMhB,IAAIiB,OAAO,CAAC;YACjCC,WAAWrB,OAAOa,EAAE,CAACS,QAAQ;YAC7BC,WAAWrB,QAAQW,EAAE,CAACS,QAAQ;QAChC;QAEAE,OAAOL,SAASM,OAAO,IAAIC,IAAI,CAAC;QAChCF,OAAO,MAAM1B,mBAAmB6B,QAAQ,CAACzB,QAAQW,EAAE,CAACS,QAAQ,KAAKI,IAAI,CAAC;IACxE;IAEAR,GAAG,8DAA8D;QAC/D,MAAMC,WAAW,MAAMhB,IAAIiB,OAAO,CAAC;YACjCC,WAAWrB,OAAOa,EAAE,CAACS,QAAQ;YAC7BC,WAAW;QACb;QAEAC,OAAOL,SAASS,MAAM,IAAIF,IAAI,CAAC;QAC/BF,OAAOL,SAASU,KAAK,EAAEC,cAAc,CAACC,4CAAqB;IAC7D;IAEAb,GAAG,8EAA8E;QAC/E,MAAMc,cAAc,MAAMvB,IAAAA,kBAAQ;QAClC,MAAMZ,gBAAgBmB,IAAI,CAACgB;QAE3B,MAAMb,WAAW,MAAMhB,IAAIiB,OAAO,CAAC;YACjCC,WAAWW,YAAYnB,EAAE,CAACS,QAAQ;YAClCC,WAAWrB,QAAQW,EAAE,CAACS,QAAQ;QAChC;QAEAE,OAAOL,SAASS,MAAM,IAAIF,IAAI,CAAC;QAC/BF,OAAOL,SAASU,KAAK,EAAEC,cAAc,CAACG,8BAAc;IACtD;AACF"}