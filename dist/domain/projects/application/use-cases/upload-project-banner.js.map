{"version":3,"sources":["../../../../../src/domain/projects/application/use-cases/upload-project-banner.ts"],"sourcesContent":["import { type Either, left, right } from '@/shared/either'\nimport { ResourceNotFoundError } from '@/shared/errors/resource-not-found.error'\nimport { UniqueEntityID } from '@/shared/kernel/unique-entity-id'\nimport type { StorageUploader } from '../../../authentication/application/storage/uploader'\nimport type { ProjectsRepository } from '../repositories/projects-repository'\n\ninterface UploadProjectBannerUseCaseRequest {\n  projectId: string\n  filename: string\n  image: Buffer\n}\n\ntype UploadProjectBannerUseCaseResponse = Either<ResourceNotFoundError, void>\n\nexport class UploadProjectBannerUseCase {\n  constructor(\n    private readonly projectsRepository: ProjectsRepository,\n    private readonly bannersUploader: StorageUploader,\n  ) {}\n\n  async execute({\n    filename,\n    image,\n    projectId,\n  }: UploadProjectBannerUseCaseRequest): Promise<UploadProjectBannerUseCaseResponse> {\n    const project = await this.projectsRepository.findById(\n      UniqueEntityID.create(projectId),\n    )\n\n    if (!project) {\n      return left(new ResourceNotFoundError('Project not found.'))\n    }\n\n    const { downloadUrl } = await this.bannersUploader.upload(image, filename)\n\n    project.editInfo({\n      bannerUrl: downloadUrl,\n    })\n\n    await this.projectsRepository.save(project)\n\n    return right(undefined)\n  }\n}\n"],"names":["UploadProjectBannerUseCase","execute","filename","image","projectId","project","projectsRepository","findById","UniqueEntityID","create","left","ResourceNotFoundError","downloadUrl","bannersUploader","upload","editInfo","bannerUrl","save","right","undefined"],"mappings":";;;;+BAcaA;;;eAAAA;;;wBAd4B;uCACH;gCACP;AAYxB,IAAA,AAAMA,6BAAN,MAAMA;IAMX,MAAMC,QAAQ,EACZC,QAAQ,EACRC,KAAK,EACLC,SAAS,EACyB,EAA+C;QACjF,MAAMC,UAAU,MAAM,IAAI,CAACC,kBAAkB,CAACC,QAAQ,CACpDC,8BAAc,CAACC,MAAM,CAACL;QAGxB,IAAI,CAACC,SAAS;YACZ,OAAOK,IAAAA,YAAI,EAAC,IAAIC,4CAAqB,CAAC;QACxC;QAEA,MAAM,EAAEC,WAAW,EAAE,GAAG,MAAM,IAAI,CAACC,eAAe,CAACC,MAAM,CAACX,OAAOD;QAEjEG,QAAQU,QAAQ,CAAC;YACfC,WAAWJ;QACb;QAEA,MAAM,IAAI,CAACN,kBAAkB,CAACW,IAAI,CAACZ;QAEnC,OAAOa,IAAAA,aAAK,EAACC;IACf;IA3BA,YACE,AAAiBb,kBAAsC,EACvD,AAAiBO,eAAgC,CACjD;aAFiBP,qBAAAA;aACAO,kBAAAA;IAChB;AAyBL"}