{"version":3,"sources":["../../../../../src/domain/projects/application/use-cases/get-draft.spec.ts"],"sourcesContent":["import type { UsersRepository } from '@/domain/authentication/application/repositories/users-repository'\nimport type { User } from '@/domain/authentication/enterprise/entities/user'\nimport type { ProjectsRepository } from '@/domain/projects/application/repositories/projects-repository'\nimport type { Project } from '@/domain/projects/enterprise/entities/project'\nimport { ForbiddenError } from '@/shared/errors/forbidden.error'\nimport { ResourceNotFoundError } from '@/shared/errors/resource-not-found.error'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryProjectsRepository } from 'test/repositories/projects-repository'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport { GetDraftUseCase } from './get-draft'\n\nlet projectsRepository: ProjectsRepository\nlet studentsRepository: UsersRepository\n\nlet student: User\nlet draft: Project\n\nlet sut: GetDraftUseCase\n\ndescribe('get draft use case', () => {\n  beforeEach(async () => {\n    projectsRepository = new InMemoryProjectsRepository()\n    studentsRepository = new InMemoryUsersRepository()\n\n    student = await makeUser()\n    draft = makeProject({\n      title: 'Design de Interação',\n      authorId: student.id,\n    })\n\n    await studentsRepository.create(student)\n    await projectsRepository.create(draft)\n\n    sut = new GetDraftUseCase(projectsRepository, studentsRepository)\n  })\n\n  it('should be able to get a draft', async () => {\n    const response = await sut.execute({\n      draftId: draft.id.toString(),\n      authorId: student.id.toString(),\n    })\n\n    expect(response.isRight()).toBe(true)\n    expect(response.value).toEqual(draft)\n  })\n\n  it('should not be able to get a draft without an author', async () => {\n    const response = await sut.execute({\n      draftId: draft.id.toString(),\n      authorId: '',\n    })\n\n    expect(response.isLeft()).toBe(true)\n    expect(response.value).toBeInstanceOf(ForbiddenError)\n  })\n\n  it('should not be able to get a draft with an invalid author', async () => {\n    const response = await sut.execute({\n      draftId: draft.id.toString(),\n      authorId: 'invalid-author-id',\n    })\n\n    expect(response.isLeft()).toBe(true)\n    expect(response.value).toBeInstanceOf(ResourceNotFoundError)\n  })\n\n  it('should not be able to get a draft with an invalid draft id', async () => {\n    const response = await sut.execute({\n      draftId: 'invalid-draft-id',\n      authorId: student.id.toString(),\n    })\n\n    expect(response.isLeft()).toBe(true)\n    expect(response.value).toBeInstanceOf(ResourceNotFoundError)\n  })\n\n  it('should not be able to get a draft of another author', async () => {\n    const anotherStudent = await makeUser()\n\n    await studentsRepository.create(anotherStudent)\n\n    const response = await sut.execute({\n      draftId: draft.id.toString(),\n      authorId: anotherStudent.id.toString(),\n    })\n\n    expect(response.isLeft()).toBe(true)\n    expect(response.value).toBeInstanceOf(ForbiddenError)\n  })\n})\n"],"names":["projectsRepository","studentsRepository","student","draft","sut","describe","beforeEach","InMemoryProjectsRepository","InMemoryUsersRepository","makeUser","makeProject","title","authorId","id","create","GetDraftUseCase","it","response","execute","draftId","toString","expect","isRight","toBe","value","toEqual","isLeft","toBeInstanceOf","ForbiddenError","ResourceNotFoundError","anotherStudent"],"mappings":";;;;gCAI+B;uCACO;6BACV;0BACH;oCACkB;iCACH;0BACR;AAEhC,IAAIA;AACJ,IAAIC;AAEJ,IAAIC;AACJ,IAAIC;AAEJ,IAAIC;AAEJC,SAAS,sBAAsB;IAC7BC,WAAW;QACTN,qBAAqB,IAAIO,8CAA0B;QACnDN,qBAAqB,IAAIO,wCAAuB;QAEhDN,UAAU,MAAMO,IAAAA,kBAAQ;QACxBN,QAAQO,IAAAA,wBAAW,EAAC;YAClBC,OAAO;YACPC,UAAUV,QAAQW,EAAE;QACtB;QAEA,MAAMZ,mBAAmBa,MAAM,CAACZ;QAChC,MAAMF,mBAAmBc,MAAM,CAACX;QAEhCC,MAAM,IAAIW,yBAAe,CAACf,oBAAoBC;IAChD;IAEAe,GAAG,iCAAiC;QAClC,MAAMC,WAAW,MAAMb,IAAIc,OAAO,CAAC;YACjCC,SAAShB,MAAMU,EAAE,CAACO,QAAQ;YAC1BR,UAAUV,QAAQW,EAAE,CAACO,QAAQ;QAC/B;QAEAC,OAAOJ,SAASK,OAAO,IAAIC,IAAI,CAAC;QAChCF,OAAOJ,SAASO,KAAK,EAAEC,OAAO,CAACtB;IACjC;IAEAa,GAAG,uDAAuD;QACxD,MAAMC,WAAW,MAAMb,IAAIc,OAAO,CAAC;YACjCC,SAAShB,MAAMU,EAAE,CAACO,QAAQ;YAC1BR,UAAU;QACZ;QAEAS,OAAOJ,SAASS,MAAM,IAAIH,IAAI,CAAC;QAC/BF,OAAOJ,SAASO,KAAK,EAAEG,cAAc,CAACC,8BAAc;IACtD;IAEAZ,GAAG,4DAA4D;QAC7D,MAAMC,WAAW,MAAMb,IAAIc,OAAO,CAAC;YACjCC,SAAShB,MAAMU,EAAE,CAACO,QAAQ;YAC1BR,UAAU;QACZ;QAEAS,OAAOJ,SAASS,MAAM,IAAIH,IAAI,CAAC;QAC/BF,OAAOJ,SAASO,KAAK,EAAEG,cAAc,CAACE,4CAAqB;IAC7D;IAEAb,GAAG,8DAA8D;QAC/D,MAAMC,WAAW,MAAMb,IAAIc,OAAO,CAAC;YACjCC,SAAS;YACTP,UAAUV,QAAQW,EAAE,CAACO,QAAQ;QAC/B;QAEAC,OAAOJ,SAASS,MAAM,IAAIH,IAAI,CAAC;QAC/BF,OAAOJ,SAASO,KAAK,EAAEG,cAAc,CAACE,4CAAqB;IAC7D;IAEAb,GAAG,uDAAuD;QACxD,MAAMc,iBAAiB,MAAMrB,IAAAA,kBAAQ;QAErC,MAAMR,mBAAmBa,MAAM,CAACgB;QAEhC,MAAMb,WAAW,MAAMb,IAAIc,OAAO,CAAC;YACjCC,SAAShB,MAAMU,EAAE,CAACO,QAAQ;YAC1BR,UAAUkB,eAAejB,EAAE,CAACO,QAAQ;QACtC;QAEAC,OAAOJ,SAASS,MAAM,IAAIH,IAAI,CAAC;QAC/BF,OAAOJ,SAASO,KAAK,EAAEG,cAAc,CAACC,8BAAc;IACtD;AACF"}