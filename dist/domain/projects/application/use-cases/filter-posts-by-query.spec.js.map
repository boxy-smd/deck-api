{"version":3,"sources":["../../../../../src/domain/projects/application/use-cases/filter-posts-by-query.spec.ts"],"sourcesContent":["import type { UsersRepository } from '@/domain/authentication/application/repositories/users-repository'\nimport type { User } from '@/domain/authentication/enterprise/entities/user'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeSubject } from 'test/factories/make-subject'\nimport { makeTrail } from 'test/factories/make-trail'\nimport { makeUser } from 'test/factories/make-user'\nimport { InMemoryProjectsRepository } from 'test/repositories/projects-repository'\nimport { InMemorySubjectsRepository } from 'test/repositories/subjects-repository'\nimport { InMemoryTrailsRepository } from 'test/repositories/trails-repository'\nimport { InMemoryUsersRepository } from 'test/repositories/users-repository'\nimport type { Project } from '../../enterprise/entities/project'\nimport type { Trail } from '../../enterprise/entities/trail'\nimport type { ProjectsRepository } from '../repositories/projects-repository'\nimport type { SubjectsRepository } from '../repositories/subjects-repository'\nimport type { TrailsRepository } from '../repositories/trails-repository'\nimport { FilterPostsByQueryUseCase } from './filter-posts-by-query'\n\nlet projectsRepository: ProjectsRepository\nlet studentsRepository: UsersRepository\nlet subjectsRepository: SubjectsRepository\nlet trailsRepository: TrailsRepository\n\nlet author: User\nlet trail: Trail\nlet project: Project\n\nlet sut: FilterPostsByQueryUseCase\n\ndescribe('filter posts by query use case', () => {\n  beforeEach(async () => {\n    studentsRepository = new InMemoryUsersRepository()\n    subjectsRepository = new InMemorySubjectsRepository()\n    trailsRepository = new InMemoryTrailsRepository()\n\n    projectsRepository = new InMemoryProjectsRepository(\n      studentsRepository,\n      subjectsRepository,\n      trailsRepository,\n      undefined,\n    )\n\n    author = await makeUser()\n    trail = makeTrail({\n      name: 'Design',\n    })\n    const subject = makeSubject({\n      name: 'Comunicação Visual I',\n    })\n\n    project = makeProject({\n      title: 'Awesome project',\n      authorId: author.id,\n      trails: new Set([trail.id]),\n      subjectId: subject.id,\n      publishedYear: 2024,\n      semester: 3,\n    })\n\n    await studentsRepository.create(author)\n    await trailsRepository.create(trail)\n    await subjectsRepository.create(subject)\n    await projectsRepository.create(project)\n\n    sut = new FilterPostsByQueryUseCase(projectsRepository)\n  })\n\n  it('should be able to filter posts by trails ids', async () => {\n    const result = await sut.execute({\n      trailsIds: [trail.id.toString()],\n    })\n\n    expect(result).length(1)\n    expect(result[0].id).toBe(project.id.toString())\n  })\n\n  it('should be able to filter posts by semester', async () => {\n    const result = await sut.execute({\n      semester: 3,\n    })\n\n    expect(result).length(1)\n    expect(result[0].id).toBe(project.id.toString())\n  })\n\n  it('should be able to filter posts by subject id', async () => {\n    const result = await sut.execute({\n      subjectId: project.subjectId?.toString(),\n    })\n\n    expect(result).length(1)\n    expect(result[0].id).toBe(project.id.toString())\n  })\n\n  it('should be able to filter posts by published year', async () => {\n    const result = await sut.execute({\n      publishedYear: 2024,\n    })\n\n    expect(result).length(1)\n    expect(result[0].id).toBe(project.id.toString())\n  })\n\n  it('should be able to filter posts by all queries', async () => {\n    const result = await sut.execute({\n      trailsIds: [trail.id.toString()],\n      semester: 3,\n      subjectId: project.subjectId?.toString(),\n      publishedYear: 2024,\n    })\n\n    expect(result).length(1)\n    expect(result[0].id).toBe(project.id.toString())\n  })\n\n  it('should return an empty array if no posts are found', async () => {\n    const result = await sut.execute({\n      trailsIds: ['invalid-id'],\n    })\n\n    expect(result).length(0)\n  })\n})\n"],"names":["projectsRepository","studentsRepository","subjectsRepository","trailsRepository","author","trail","project","sut","describe","beforeEach","InMemoryUsersRepository","InMemorySubjectsRepository","InMemoryTrailsRepository","InMemoryProjectsRepository","undefined","makeUser","makeTrail","name","subject","makeSubject","makeProject","title","authorId","id","trails","Set","subjectId","publishedYear","semester","create","FilterPostsByQueryUseCase","it","result","execute","trailsIds","toString","expect","length","toBe"],"mappings":"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"}