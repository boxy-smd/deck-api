{"version":3,"sources":["../../../../../src/domain/projects/enterprise/entities/project.ts"],"sourcesContent":["import type { StudentProfile } from '@/domain/authentication/enterprise/entities/student-profile'\nimport { AggregateRoot } from '@/shared/kernel/aggregate-root'\nimport type { UniqueEntityID } from '@/shared/kernel/unique-entity-id'\nimport type { Optional } from '@/shared/types/optional'\nimport { Comment } from '../../../interaction/enterprise/entities/comment'\nimport { ProjectStatus } from '../value-objects/project-status'\nimport type { Professor } from './professor'\nimport type { Subject } from './subject'\nimport type { Trail } from './trail'\n\nexport interface ProjectProps {\n  title: string\n  description?: string\n  bannerUrl?: string\n  content?: string\n  publishedYear?: number\n  status: ProjectStatus\n  semester?: number\n  allowComments: boolean\n\n  authorId: UniqueEntityID<StudentProfile>\n  subjectId?: UniqueEntityID<Subject>\n  trails: Set<UniqueEntityID<Trail>>\n  professors: Set<UniqueEntityID<Professor>>\n  comments: Set<Comment>\n}\n\nexport class Project extends AggregateRoot<ProjectProps> {\n  // --- 1. Factory methods ---\n  static create(\n    props: Optional<ProjectProps, 'trails' | 'professors' | 'comments'>,\n    id?: UniqueEntityID,\n  ): Project {\n    return new Project(\n      {\n        ...props,\n        trails: props.trails ?? new Set<UniqueEntityID<Trail>>(),\n        professors: props.professors ?? new Set<UniqueEntityID<Professor>>(),\n        comments: props.comments ?? new Set<Comment>(),\n      },\n      id,\n    )\n  }\n\n  static reconstitute(\n    props: ProjectProps,\n    id: UniqueEntityID,\n    createdAt: Date,\n    updatedAt: Date,\n  ): Project {\n    return new Project(props, id, createdAt, updatedAt)\n  }\n\n  // -- 2. Public methods ---\n  public addToDrafts() {\n    this.props.status = ProjectStatus.DRAFT\n    this.touch()\n  }\n\n  public post() {\n    this.props.status = ProjectStatus.PUBLISHED\n    this.touch()\n  }\n\n  public archive() {\n    this.props.status = ProjectStatus.ARCHIVED\n    this.touch()\n  }\n\n  public unarchive() {\n    this.props.status = ProjectStatus.PUBLISHED\n    this.touch()\n  }\n\n  public editInfo({\n    title,\n    description,\n    bannerUrl,\n    content,\n    publishedYear,\n    semester,\n    allowComments,\n    subjectId,\n  }: Partial<\n    Pick<\n      ProjectProps,\n      | 'title'\n      | 'description'\n      | 'bannerUrl'\n      | 'content'\n      | 'publishedYear'\n      | 'semester'\n      | 'allowComments'\n      | 'subjectId'\n    >\n  >) {\n    if (title) {\n      this.props.title = title\n    }\n\n    if (description) {\n      this.props.description = description\n    }\n\n    if (bannerUrl) {\n      this.props.bannerUrl = bannerUrl\n    }\n\n    if (content) {\n      this.props.content = content\n    }\n\n    if (publishedYear) {\n      this.props.publishedYear = publishedYear\n    }\n\n    if (semester) {\n      this.props.semester = semester\n    }\n\n    if (allowComments) {\n      this.props.allowComments = allowComments\n    }\n\n    if (subjectId) {\n      this.props.subjectId = subjectId\n    }\n\n    this.touch()\n  }\n\n  public defineTrails(trails: UniqueEntityID<Trail>[]) {\n    this.props.trails = new Set(trails)\n    this.touch()\n  }\n\n  public defineProfessors(professors: UniqueEntityID<Professor>[]) {\n    this.props.professors = new Set(professors)\n    this.touch()\n  }\n\n  public comment(content: string, authorId: UniqueEntityID<StudentProfile>) {\n    const comment = Comment.create({\n      content,\n      authorId,\n      projectId: this.id,\n    })\n\n    this.props.comments.add(comment)\n    this.touch()\n\n    return comment\n  }\n\n  public removeComment(comment: Comment) {\n    this.props.comments.delete(comment)\n    this.touch()\n  }\n\n  // --- 3. Getters ---\n  get title() {\n    return this.props.title\n  }\n\n  get description() {\n    return this.props.description\n  }\n\n  get bannerUrl() {\n    return this.props.bannerUrl\n  }\n\n  get content() {\n    return this.props.content || ''\n  }\n\n  get publishedYear() {\n    return this.props.publishedYear\n  }\n\n  get status() {\n    return this.props.status\n  }\n\n  get semester() {\n    return this.props.semester\n  }\n\n  get allowComments() {\n    return this.props.allowComments\n  }\n\n  get authorId() {\n    return this.props.authorId\n  }\n\n  get subjectId() {\n    return this.props.subjectId\n  }\n\n  get trails() {\n    return [...this.props.trails]\n  }\n\n  get professors() {\n    return [...this.props.professors]\n  }\n\n  get comments() {\n    return [...this.props.comments]\n  }\n}\n"],"names":["Project","AggregateRoot","create","props","id","trails","Set","professors","comments","reconstitute","createdAt","updatedAt","addToDrafts","status","ProjectStatus","DRAFT","touch","post","PUBLISHED","archive","ARCHIVED","unarchive","editInfo","title","description","bannerUrl","content","publishedYear","semester","allowComments","subjectId","defineTrails","defineProfessors","comment","authorId","Comment","projectId","add","removeComment","delete"],"mappings":"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"}