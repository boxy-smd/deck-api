{"version":3,"sources":["../../../../../src/interface/http/controllers/comments/comment-on-project.controller.e2e-spec.ts"],"sourcesContent":["import request from 'supertest'\n\nimport { app } from '@/app'\nimport { PrismaProjectsRepository } from '@/infra/database/prisma/repositories/projects-repository'\nimport { PrismaSubjectsRepository } from '@/infra/database/prisma/repositories/subjects-repository'\nimport { UniqueEntityID } from '@/shared/kernel/unique-entity-id'\nimport { createAndAuthenticateStudent } from 'test/e2e/create-and-authenticate-students'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeSubject } from 'test/factories/make-subject'\n\ndescribe('comment on project (e2e)', () => {\n  beforeAll(async () => {\n    await app.ready()\n  })\n\n  afterAll(async () => {\n    await app.close()\n  })\n\n  it('should be able to comment on project', async () => {\n    const { studentId, token, trail } = await createAndAuthenticateStudent()\n\n    const subjectsRepository = new PrismaSubjectsRepository()\n    const projectsRepository = new PrismaProjectsRepository()\n\n    const subject = makeSubject()\n    const project = makeProject({\n      authorId: new UniqueEntityID(studentId),\n      subjectId: subject.id,\n      trails: new Set([trail.id]),\n    })\n\n    await subjectsRepository.create(subject)\n    await projectsRepository.create(project)\n\n    const result = await request(app.server)\n      .post(`/projects/${project.id.toString()}/comments`)\n      .set('Authorization', `Bearer ${token}`)\n      .send({\n        content: 'This is a comment.',\n      })\n\n    expect(result.status).toBe(201)\n    expect(result.body).toEqual({\n      comment_id: expect.any(String),\n    })\n  })\n})\n"],"names":["describe","beforeAll","app","ready","afterAll","close","it","studentId","token","trail","createAndAuthenticateStudent","subjectsRepository","PrismaSubjectsRepository","projectsRepository","PrismaProjectsRepository","subject","makeSubject","project","makeProject","authorId","UniqueEntityID","subjectId","id","trails","Set","create","result","request","server","post","toString","set","send","content","expect","status","toBe","body","toEqual","comment_id","any","String"],"mappings":";;;;kEAAoB;qBAEA;oCACqB;oCACA;gCACV;+CACc;6BACjB;6BACA;;;;;;AAE5BA,SAAS,4BAA4B;IACnCC,UAAU;QACR,MAAMC,QAAG,CAACC,KAAK;IACjB;IAEAC,SAAS;QACP,MAAMF,QAAG,CAACG,KAAK;IACjB;IAEAC,GAAG,wCAAwC;QACzC,MAAM,EAAEC,SAAS,EAAEC,KAAK,EAAEC,KAAK,EAAE,GAAG,MAAMC,IAAAA,2DAA4B;QAEtE,MAAMC,qBAAqB,IAAIC,4CAAwB;QACvD,MAAMC,qBAAqB,IAAIC,4CAAwB;QAEvD,MAAMC,UAAUC,IAAAA,wBAAW;QAC3B,MAAMC,UAAUC,IAAAA,wBAAW,EAAC;YAC1BC,UAAU,IAAIC,8BAAc,CAACb;YAC7Bc,WAAWN,QAAQO,EAAE;YACrBC,QAAQ,IAAIC,IAAI;gBAACf,MAAMa,EAAE;aAAC;QAC5B;QAEA,MAAMX,mBAAmBc,MAAM,CAACV;QAChC,MAAMF,mBAAmBY,MAAM,CAACR;QAEhC,MAAMS,SAAS,MAAMC,IAAAA,kBAAO,EAACzB,QAAG,CAAC0B,MAAM,EACpCC,IAAI,CAAC,CAAC,UAAU,EAAEZ,QAAQK,EAAE,CAACQ,QAAQ,GAAG,SAAS,CAAC,EAClDC,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAEvB,OAAO,EACtCwB,IAAI,CAAC;YACJC,SAAS;QACX;QAEFC,OAAOR,OAAOS,MAAM,EAAEC,IAAI,CAAC;QAC3BF,OAAOR,OAAOW,IAAI,EAAEC,OAAO,CAAC;YAC1BC,YAAYL,OAAOM,GAAG,CAACC;QACzB;IACF;AACF"}