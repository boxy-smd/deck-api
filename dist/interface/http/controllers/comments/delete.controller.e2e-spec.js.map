{"version":3,"sources":["../../../../../src/interface/http/controllers/comments/delete.controller.e2e-spec.ts"],"sourcesContent":["import request from 'supertest'\n\nimport { app } from '@/app'\nimport { PrismaCommentsRepository } from '@/infra/database/prisma/repositories/comments-repository'\nimport { PrismaProfessorsRepository } from '@/infra/database/prisma/repositories/professors-repository'\nimport { PrismaProjectsRepository } from '@/infra/database/prisma/repositories/projects-repository'\nimport { PrismaReportsRepository } from '@/infra/database/prisma/repositories/reports-repository'\nimport { PrismaSubjectsRepository } from '@/infra/database/prisma/repositories/subjects-repository'\nimport { UniqueEntityID } from '@/shared/kernel/unique-entity-id'\nimport { createAndAuthenticateStudent } from 'test/e2e/create-and-authenticate-students'\nimport { makeComment } from 'test/factories/make-comment'\nimport { makeProfessor } from 'test/factories/make-professor'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeSubject } from 'test/factories/make-subject'\n\ndescribe('delete comment (e2e)', () => {\n  beforeAll(async () => {\n    await app.ready()\n  })\n\n  afterAll(async () => {\n    await app.close()\n  })\n\n  it('should be able to delete a comment', async () => {\n    const { studentId, token, trail } = await createAndAuthenticateStudent()\n\n    const professorsRepository = new PrismaProfessorsRepository()\n    const subjectsRepository = new PrismaSubjectsRepository()\n    const projectsRepository = new PrismaProjectsRepository()\n    const reportsRepository = new PrismaReportsRepository()\n    const commentsRepository = new PrismaCommentsRepository(reportsRepository)\n\n    const professor = makeProfessor({\n      name: 'Ticianne de Gois Ribeiro Darin',\n    })\n\n    const subject = makeSubject({\n      name: 'Interação Humano-Computador I',\n    })\n\n    const project = makeProject({\n      authorId: new UniqueEntityID(studentId),\n      trails: new Set([trail.id]),\n    })\n\n    await professorsRepository.create(professor)\n    await subjectsRepository.create(subject)\n    await projectsRepository.create(project)\n\n    const comment = makeComment({\n      authorId: new UniqueEntityID(studentId),\n      projectId: project.id,\n    })\n\n    await commentsRepository.create(comment)\n\n    const response = await request(app.server)\n      .delete(\n        `/projects/${project.id.toString()}/comments/${comment.id.toString()}`,\n      )\n      .set('Authorization', `Bearer ${token}`)\n\n    expect(response.status).toBe(204)\n  })\n})\n"],"names":["describe","beforeAll","app","ready","afterAll","close","it","studentId","token","trail","createAndAuthenticateStudent","professorsRepository","PrismaProfessorsRepository","subjectsRepository","PrismaSubjectsRepository","projectsRepository","PrismaProjectsRepository","reportsRepository","PrismaReportsRepository","commentsRepository","PrismaCommentsRepository","professor","makeProfessor","name","subject","makeSubject","project","makeProject","authorId","UniqueEntityID","trails","Set","id","create","comment","makeComment","projectId","response","request","server","delete","toString","set","expect","status","toBe"],"mappings":";;;;kEAAoB;qBAEA;oCACqB;sCACE;oCACF;mCACD;oCACC;gCACV;+CACc;6BACjB;+BACE;6BACF;6BACA;;;;;;AAE5BA,SAAS,wBAAwB;IAC/BC,UAAU;QACR,MAAMC,QAAG,CAACC,KAAK;IACjB;IAEAC,SAAS;QACP,MAAMF,QAAG,CAACG,KAAK;IACjB;IAEAC,GAAG,sCAAsC;QACvC,MAAM,EAAEC,SAAS,EAAEC,KAAK,EAAEC,KAAK,EAAE,GAAG,MAAMC,IAAAA,2DAA4B;QAEtE,MAAMC,uBAAuB,IAAIC,gDAA0B;QAC3D,MAAMC,qBAAqB,IAAIC,4CAAwB;QACvD,MAAMC,qBAAqB,IAAIC,4CAAwB;QACvD,MAAMC,oBAAoB,IAAIC,0CAAuB;QACrD,MAAMC,qBAAqB,IAAIC,4CAAwB,CAACH;QAExD,MAAMI,YAAYC,IAAAA,4BAAa,EAAC;YAC9BC,MAAM;QACR;QAEA,MAAMC,UAAUC,IAAAA,wBAAW,EAAC;YAC1BF,MAAM;QACR;QAEA,MAAMG,UAAUC,IAAAA,wBAAW,EAAC;YAC1BC,UAAU,IAAIC,8BAAc,CAACtB;YAC7BuB,QAAQ,IAAIC,IAAI;gBAACtB,MAAMuB,EAAE;aAAC;QAC5B;QAEA,MAAMrB,qBAAqBsB,MAAM,CAACZ;QAClC,MAAMR,mBAAmBoB,MAAM,CAACT;QAChC,MAAMT,mBAAmBkB,MAAM,CAACP;QAEhC,MAAMQ,UAAUC,IAAAA,wBAAW,EAAC;YAC1BP,UAAU,IAAIC,8BAAc,CAACtB;YAC7B6B,WAAWV,QAAQM,EAAE;QACvB;QAEA,MAAMb,mBAAmBc,MAAM,CAACC;QAEhC,MAAMG,WAAW,MAAMC,IAAAA,kBAAO,EAACpC,QAAG,CAACqC,MAAM,EACtCC,MAAM,CACL,CAAC,UAAU,EAAEd,QAAQM,EAAE,CAACS,QAAQ,GAAG,UAAU,EAAEP,QAAQF,EAAE,CAACS,QAAQ,IAAI,EAEvEC,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAElC,OAAO;QAEzCmC,OAAON,SAASO,MAAM,EAAEC,IAAI,CAAC;IAC/B;AACF"}