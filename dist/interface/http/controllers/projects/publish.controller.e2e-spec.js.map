{"version":3,"sources":["../../../../../src/interface/http/controllers/projects/publish.controller.e2e-spec.ts"],"sourcesContent":["import request from 'supertest'\n\nimport { app } from '@/app'\nimport { PrismaProfessorsRepository } from '@/infra/database/prisma/repositories/professors-repository'\nimport { PrismaSubjectsRepository } from '@/infra/database/prisma/repositories/subjects-repository'\nimport { createAndAuthenticateStudent } from 'test/e2e/create-and-authenticate-students'\nimport { makeProfessor } from 'test/factories/make-professor'\nimport { makeSubject } from 'test/factories/make-subject'\n\ndescribe('publish project (e2e)', () => {\n  beforeAll(async () => {\n    await app.ready()\n  })\n\n  afterAll(async () => {\n    await app.close()\n  })\n\n  it('should be able to publish a project', async () => {\n    const { token, trail } = await createAndAuthenticateStudent()\n\n    const professorsRepository = new PrismaProfessorsRepository()\n    const subjectsRepository = new PrismaSubjectsRepository()\n\n    const professor = makeProfessor({\n      name: 'Ticianne de Gois Ribeiro Darin',\n    })\n\n    const subject = makeSubject({\n      name: 'Interação Humano-Computador I',\n    })\n\n    await professorsRepository.create(professor)\n    await subjectsRepository.create(subject)\n\n    const response = await request(app.server)\n      .post('/projects')\n      .set('Authorization', `Bearer ${token}`)\n      .send({\n        title: 'Design de Interação',\n        description: 'Projeto de Design de Interação',\n        bannerUrl: 'https://example.com/banner.jpg',\n        content: 'Conteúdo do projeto',\n        publishedYear: 2021,\n        semester: 3,\n        allowComments: true,\n        subjectId: subject.id.toString(),\n        trailsIds: [trail.id.toString()],\n        professorsIds: [professor.id.toString()],\n      })\n\n    expect(response.status).toBe(201)\n    expect(response.body).toEqual({\n      project_id: expect.any(String),\n    })\n  })\n})\n"],"names":["describe","beforeAll","app","ready","afterAll","close","it","token","trail","createAndAuthenticateStudent","professorsRepository","PrismaProfessorsRepository","subjectsRepository","PrismaSubjectsRepository","professor","makeProfessor","name","subject","makeSubject","create","response","request","server","post","set","send","title","description","bannerUrl","content","publishedYear","semester","allowComments","subjectId","id","toString","trailsIds","professorsIds","expect","status","toBe","body","toEqual","project_id","any","String"],"mappings":";;;;kEAAoB;qBAEA;sCACuB;oCACF;+CACI;+BACf;6BACF;;;;;;AAE5BA,SAAS,yBAAyB;IAChCC,UAAU;QACR,MAAMC,QAAG,CAACC,KAAK;IACjB;IAEAC,SAAS;QACP,MAAMF,QAAG,CAACG,KAAK;IACjB;IAEAC,GAAG,uCAAuC;QACxC,MAAM,EAAEC,KAAK,EAAEC,KAAK,EAAE,GAAG,MAAMC,IAAAA,2DAA4B;QAE3D,MAAMC,uBAAuB,IAAIC,gDAA0B;QAC3D,MAAMC,qBAAqB,IAAIC,4CAAwB;QAEvD,MAAMC,YAAYC,IAAAA,4BAAa,EAAC;YAC9BC,MAAM;QACR;QAEA,MAAMC,UAAUC,IAAAA,wBAAW,EAAC;YAC1BF,MAAM;QACR;QAEA,MAAMN,qBAAqBS,MAAM,CAACL;QAClC,MAAMF,mBAAmBO,MAAM,CAACF;QAEhC,MAAMG,WAAW,MAAMC,IAAAA,kBAAO,EAACnB,QAAG,CAACoB,MAAM,EACtCC,IAAI,CAAC,aACLC,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAEjB,OAAO,EACtCkB,IAAI,CAAC;YACJC,OAAO;YACPC,aAAa;YACbC,WAAW;YACXC,SAAS;YACTC,eAAe;YACfC,UAAU;YACVC,eAAe;YACfC,WAAWhB,QAAQiB,EAAE,CAACC,QAAQ;YAC9BC,WAAW;gBAAC5B,MAAM0B,EAAE,CAACC,QAAQ;aAAG;YAChCE,eAAe;gBAACvB,UAAUoB,EAAE,CAACC,QAAQ;aAAG;QAC1C;QAEFG,OAAOlB,SAASmB,MAAM,EAAEC,IAAI,CAAC;QAC7BF,OAAOlB,SAASqB,IAAI,EAAEC,OAAO,CAAC;YAC5BC,YAAYL,OAAOM,GAAG,CAACC;QACzB;IACF;AACF"}