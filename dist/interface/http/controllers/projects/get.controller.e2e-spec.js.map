{"version":3,"sources":["../../../../../src/interface/http/controllers/projects/get.controller.e2e-spec.ts"],"sourcesContent":["import request from 'supertest'\n\nimport { app } from '@/app'\nimport { PrismaProjectsRepository } from '@/infra/database/prisma/repositories/projects-repository'\nimport { PrismaStudentsRepository } from '@/infra/database/prisma/repositories/students-repository'\nimport { PrismaSubjectsRepository } from '@/infra/database/prisma/repositories/subjects-repository'\nimport { PrismaTrailsRepository } from '@/infra/database/prisma/repositories/trails-repository'\nimport { makeProject } from 'test/factories/make-project'\nimport { makeUser } from 'test/factories/make-user'\nimport { makeSubject } from 'test/factories/make-subject'\nimport { makeTrail } from 'test/factories/make-trail'\n\ndescribe('get project (e2e)', () => {\n  beforeAll(async () => {\n    await app.ready()\n  })\n\n  afterAll(async () => {\n    await app.close()\n  })\n\n  it('should be able to get a project', async () => {\n    const projectsRepository = new PrismaProjectsRepository()\n    const studentsRepository = new PrismaStudentsRepository(\n      projectsRepository,\n    )\n    const trailsRepository = new PrismaTrailsRepository()\n    const subjectsRepository = new PrismaSubjectsRepository()\n\n    const author = await makeUser()\n    const trail = makeTrail()\n    const subject = makeSubject()\n    const project = makeProject({\n      authorId: author.id,\n      subjectId: subject.id,\n      trails: new Set([trail.id]),\n    })\n\n    await studentsRepository.create(author)\n    await trailsRepository.create(trail)\n    await subjectsRepository.create(subject)\n    await projectsRepository.create(project)\n\n    const result = await request(app.server).get(\n      `/projects/${project.id.toString()}`,\n    )\n\n    expect(result.status).toBe(200)\n    expect(result.body.project).toMatchObject({\n      id: project.id.toString(),\n      title: project.title,\n      description: project.description,\n      bannerUrl: project.bannerUrl,\n      publishedYear: project.publishedYear,\n      status: project.status,\n      semester: project.semester,\n      allowComments: project.allowComments,\n      createdAt: expect.any(String),\n      updatedAt: expect.any(String),\n      authorId: project.authorId.toString(),\n      author: {\n        name: author.name,\n        username: author.username.value,\n        profileUrl: author.profileUrl,\n      },\n      subjectId: project.subjectId?.toString(),\n      subject: subject.name,\n      professors: [],\n      comments: [],\n    })\n    expect(result.body.project.trails).toContain(trail.name)\n  })\n})\n"],"names":["describe","beforeAll","app","ready","afterAll","close","it","projectsRepository","PrismaProjectsRepository","studentsRepository","PrismaStudentsRepository","trailsRepository","PrismaTrailsRepository","subjectsRepository","PrismaSubjectsRepository","author","makeUser","trail","makeTrail","subject","makeSubject","project","makeProject","authorId","id","subjectId","trails","Set","create","result","request","server","get","toString","expect","status","toBe","body","toMatchObject","title","description","bannerUrl","publishedYear","semester","allowComments","createdAt","any","String","updatedAt","name","username","value","profileUrl","professors","comments","toContain"],"mappings":";;;;kEAAoB;qBAEA;oCACqB;oCACA;oCACA;kCACF;6BACX;0BACH;6BACG;2BACF;;;;;;AAE1BA,SAAS,qBAAqB;IAC5BC,UAAU;QACR,MAAMC,QAAG,CAACC,KAAK;IACjB;IAEAC,SAAS;QACP,MAAMF,QAAG,CAACG,KAAK;IACjB;IAEAC,GAAG,mCAAmC;QACpC,MAAMC,qBAAqB,IAAIC,4CAAwB;QACvD,MAAMC,qBAAqB,IAAIC,4CAAwB,CACrDH;QAEF,MAAMI,mBAAmB,IAAIC,wCAAsB;QACnD,MAAMC,qBAAqB,IAAIC,4CAAwB;QAEvD,MAAMC,SAAS,MAAMC,IAAAA,kBAAQ;QAC7B,MAAMC,QAAQC,IAAAA,oBAAS;QACvB,MAAMC,UAAUC,IAAAA,wBAAW;QAC3B,MAAMC,UAAUC,IAAAA,wBAAW,EAAC;YAC1BC,UAAUR,OAAOS,EAAE;YACnBC,WAAWN,QAAQK,EAAE;YACrBE,QAAQ,IAAIC,IAAI;gBAACV,MAAMO,EAAE;aAAC;QAC5B;QAEA,MAAMf,mBAAmBmB,MAAM,CAACb;QAChC,MAAMJ,iBAAiBiB,MAAM,CAACX;QAC9B,MAAMJ,mBAAmBe,MAAM,CAACT;QAChC,MAAMZ,mBAAmBqB,MAAM,CAACP;QAEhC,MAAMQ,SAAS,MAAMC,IAAAA,kBAAO,EAAC5B,QAAG,CAAC6B,MAAM,EAAEC,GAAG,CAC1C,CAAC,UAAU,EAAEX,QAAQG,EAAE,CAACS,QAAQ,IAAI;QAGtCC,OAAOL,OAAOM,MAAM,EAAEC,IAAI,CAAC;QAC3BF,OAAOL,OAAOQ,IAAI,CAAChB,OAAO,EAAEiB,aAAa,CAAC;YACxCd,IAAIH,QAAQG,EAAE,CAACS,QAAQ;YACvBM,OAAOlB,QAAQkB,KAAK;YACpBC,aAAanB,QAAQmB,WAAW;YAChCC,WAAWpB,QAAQoB,SAAS;YAC5BC,eAAerB,QAAQqB,aAAa;YACpCP,QAAQd,QAAQc,MAAM;YACtBQ,UAAUtB,QAAQsB,QAAQ;YAC1BC,eAAevB,QAAQuB,aAAa;YACpCC,WAAWX,OAAOY,GAAG,CAACC;YACtBC,WAAWd,OAAOY,GAAG,CAACC;YACtBxB,UAAUF,QAAQE,QAAQ,CAACU,QAAQ;YACnClB,QAAQ;gBACNkC,MAAMlC,OAAOkC,IAAI;gBACjBC,UAAUnC,OAAOmC,QAAQ,CAACC,KAAK;gBAC/BC,YAAYrC,OAAOqC,UAAU;YAC/B;YACA3B,WAAWJ,QAAQI,SAAS,EAAEQ;YAC9Bd,SAASA,QAAQ8B,IAAI;YACrBI,YAAY,EAAE;YACdC,UAAU,EAAE;QACd;QACApB,OAAOL,OAAOQ,IAAI,CAAChB,OAAO,CAACK,MAAM,EAAE6B,SAAS,CAACtC,MAAMgC,IAAI;IACzD;AACF"}