{"version":3,"sources":["../../../../../src/interface/http/controllers/students/login.controller.e2e-spec.ts"],"sourcesContent":["import request from 'supertest'\n\nimport { app } from '@/app'\nimport { PrismaTrailsRepository } from '@/infra/database/prisma/repositories/trails-repository'\nimport { makeTrail } from 'test/factories/make-trail'\n\ndescribe('authenticate controller (e2e)', () => {\n  beforeAll(async () => {\n    await app.ready()\n  })\n\n  afterAll(async () => {\n    await app.close()\n  })\n\n  it('should be able to authenticate a user', async () => {\n    const trail = makeTrail()\n    const trailsRepository = new PrismaTrailsRepository()\n\n    await trailsRepository.create(trail)\n\n    await request(app.server)\n      .post('/students')\n      .send({\n        name: 'John Doe',\n        username: 'johndoe',\n        email: 'johndoe@alu.ufc.br',\n        password: '123456',\n        semester: 1,\n        trailsIds: [trail.id.toString()],\n      })\n\n    const response = await request(app.server).post('/sessions').send({\n      email: 'johndoe@alu.ufc.br',\n      password: '123456',\n    })\n\n    expect(response.status).toBe(200)\n    expect(response.body).toMatchObject({\n      token: expect.any(String),\n    })\n  })\n})\n"],"names":["describe","beforeAll","app","ready","afterAll","close","it","trail","makeTrail","trailsRepository","PrismaTrailsRepository","create","request","server","post","send","name","username","email","password","semester","trailsIds","id","toString","response","expect","status","toBe","body","toMatchObject","token","any","String"],"mappings":";;;;kEAAoB;qBAEA;kCACmB;2BACb;;;;;;AAE1BA,SAAS,iCAAiC;IACxCC,UAAU;QACR,MAAMC,QAAG,CAACC,KAAK;IACjB;IAEAC,SAAS;QACP,MAAMF,QAAG,CAACG,KAAK;IACjB;IAEAC,GAAG,yCAAyC;QAC1C,MAAMC,QAAQC,IAAAA,oBAAS;QACvB,MAAMC,mBAAmB,IAAIC,wCAAsB;QAEnD,MAAMD,iBAAiBE,MAAM,CAACJ;QAE9B,MAAMK,IAAAA,kBAAO,EAACV,QAAG,CAACW,MAAM,EACrBC,IAAI,CAAC,aACLC,IAAI,CAAC;YACJC,MAAM;YACNC,UAAU;YACVC,OAAO;YACPC,UAAU;YACVC,UAAU;YACVC,WAAW;gBAACd,MAAMe,EAAE,CAACC,QAAQ;aAAG;QAClC;QAEF,MAAMC,WAAW,MAAMZ,IAAAA,kBAAO,EAACV,QAAG,CAACW,MAAM,EAAEC,IAAI,CAAC,aAAaC,IAAI,CAAC;YAChEG,OAAO;YACPC,UAAU;QACZ;QAEAM,OAAOD,SAASE,MAAM,EAAEC,IAAI,CAAC;QAC7BF,OAAOD,SAASI,IAAI,EAAEC,aAAa,CAAC;YAClCC,OAAOL,OAAOM,GAAG,CAACC;QACpB;IACF;AACF"}