{"version":3,"sources":["../../../../../src/interface/http/controllers/subjects/fetch.controller.e2e-spec.ts"],"sourcesContent":["import request from 'supertest'\n\nimport { app } from '@/app'\nimport { PrismaSubjectsRepository } from '@/infra/database/prisma/repositories/subjects-repository'\nimport { makeSubject } from 'test/factories/make-subject'\n\ndescribe('fetch subjects controller (e2e)', () => {\n  beforeAll(async () => {\n    await app.ready()\n  })\n\n  afterAll(async () => {\n    await app.close()\n  })\n\n  it('should be able to fetch subjects', async () => {\n    const subjectRepository = new PrismaSubjectsRepository()\n\n    const ihc = makeSubject({\n      code: 'SMD0108',\n      name: 'Interação Humano-Computador I',\n    })\n\n    const de = makeSubject({\n      code: 'SMD0130',\n      name: 'Design Emocional',\n    })\n\n    await subjectRepository.create(ihc)\n    await subjectRepository.create(de)\n\n    const response = await request(app.server).get('/subjects')\n\n    expect(response.status).toBe(200)\n    expect(response.body).toMatchObject({\n      subjects: [\n        { id: de.id.toString(), name: de.name },\n        { id: ihc.id.toString(), name: ihc.name },\n      ],\n    })\n  })\n\n  it('should be able to fetch subjects by name', async () => {\n    const subjectRepository = new PrismaSubjectsRepository()\n\n    const am = makeSubject({\n      code: 'SMD0088',\n      name: 'Autoração Multimídia I',\n    })\n\n    const pw = makeSubject({\n      code: 'SMD0052',\n      name: 'Programação para Web I',\n    })\n\n    await subjectRepository.create(am)\n    await subjectRepository.create(pw)\n\n    const response = await request(app.server).get('/subjects').query({\n      name: 'Web',\n    })\n\n    expect(response.status).toBe(200)\n    expect(response.body).toMatchObject({\n      subjects: [{ id: pw.id.toString(), name: pw.name }],\n    })\n  })\n})\n"],"names":["describe","beforeAll","app","ready","afterAll","close","it","subjectRepository","PrismaSubjectsRepository","ihc","makeSubject","code","name","de","create","response","request","server","get","expect","status","toBe","body","toMatchObject","subjects","id","toString","am","pw","query"],"mappings":";;;;kEAAoB;qBAEA;oCACqB;6BACb;;;;;;AAE5BA,SAAS,mCAAmC;IAC1CC,UAAU;QACR,MAAMC,QAAG,CAACC,KAAK;IACjB;IAEAC,SAAS;QACP,MAAMF,QAAG,CAACG,KAAK;IACjB;IAEAC,GAAG,oCAAoC;QACrC,MAAMC,oBAAoB,IAAIC,4CAAwB;QAEtD,MAAMC,MAAMC,IAAAA,wBAAW,EAAC;YACtBC,MAAM;YACNC,MAAM;QACR;QAEA,MAAMC,KAAKH,IAAAA,wBAAW,EAAC;YACrBC,MAAM;YACNC,MAAM;QACR;QAEA,MAAML,kBAAkBO,MAAM,CAACL;QAC/B,MAAMF,kBAAkBO,MAAM,CAACD;QAE/B,MAAME,WAAW,MAAMC,IAAAA,kBAAO,EAACd,QAAG,CAACe,MAAM,EAAEC,GAAG,CAAC;QAE/CC,OAAOJ,SAASK,MAAM,EAAEC,IAAI,CAAC;QAC7BF,OAAOJ,SAASO,IAAI,EAAEC,aAAa,CAAC;YAClCC,UAAU;gBACR;oBAAEC,IAAIZ,GAAGY,EAAE,CAACC,QAAQ;oBAAId,MAAMC,GAAGD,IAAI;gBAAC;gBACtC;oBAAEa,IAAIhB,IAAIgB,EAAE,CAACC,QAAQ;oBAAId,MAAMH,IAAIG,IAAI;gBAAC;aACzC;QACH;IACF;IAEAN,GAAG,4CAA4C;QAC7C,MAAMC,oBAAoB,IAAIC,4CAAwB;QAEtD,MAAMmB,KAAKjB,IAAAA,wBAAW,EAAC;YACrBC,MAAM;YACNC,MAAM;QACR;QAEA,MAAMgB,KAAKlB,IAAAA,wBAAW,EAAC;YACrBC,MAAM;YACNC,MAAM;QACR;QAEA,MAAML,kBAAkBO,MAAM,CAACa;QAC/B,MAAMpB,kBAAkBO,MAAM,CAACc;QAE/B,MAAMb,WAAW,MAAMC,IAAAA,kBAAO,EAACd,QAAG,CAACe,MAAM,EAAEC,GAAG,CAAC,aAAaW,KAAK,CAAC;YAChEjB,MAAM;QACR;QAEAO,OAAOJ,SAASK,MAAM,EAAEC,IAAI,CAAC;QAC7BF,OAAOJ,SAASO,IAAI,EAAEC,aAAa,CAAC;YAClCC,UAAU;gBAAC;oBAAEC,IAAIG,GAAGH,EAAE,CAACC,QAAQ;oBAAId,MAAMgB,GAAGhB,IAAI;gBAAC;aAAE;QACrD;IACF;AACF"}