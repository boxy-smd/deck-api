{"version":3,"sources":["../../../../../src/@presentation/modules/auth/strategies/jwt.strategy.ts"],"sourcesContent":["import { env } from '@/@infra/config/env/env'\nimport { Injectable } from '@nestjs/common'\nimport { PassportStrategy } from '@nestjs/passport'\nimport { ExtractJwt, Strategy } from 'passport-jwt'\n\ninterface JwtPayload {\n  sub: string\n  role: string\n}\n\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) {\n  constructor() {\n    super({\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n      ignoreExpiration: false,\n      secretOrKey: env.JWT_SECRET,\n    })\n  }\n\n  async validate(payload: JwtPayload) {\n    return new Promise<{ userId: string; role: string }>(resolve => {\n      resolve({ userId: payload.sub, role: payload.role })\n    })\n  }\n}\n"],"names":["JwtStrategy","PassportStrategy","Strategy","validate","payload","Promise","resolve","userId","sub","role","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","ignoreExpiration","secretOrKey","env","JWT_SECRET"],"mappings":";;;;+BAWaA;;;eAAAA;;;qBAXO;wBACO;0BACM;6BACI;;;;;;;;;;AAQ9B,IAAA,AAAMA,cAAN,MAAMA,oBAAoBC,IAAAA,0BAAgB,EAACC,qBAAQ;IASxD,MAAMC,SAASC,OAAmB,EAAE;QAClC,OAAO,IAAIC,QAA0CC,CAAAA;YACnDA,QAAQ;gBAAEC,QAAQH,QAAQI,GAAG;gBAAEC,MAAML,QAAQK,IAAI;YAAC;QACpD;IACF;IAZA,aAAc;QACZ,KAAK,CAAC;YACJC,gBAAgBC,uBAAU,CAACC,2BAA2B;YACtDC,kBAAkB;YAClBC,aAAaC,QAAG,CAACC,UAAU;QAC7B;IACF;AAOF"}