{"version":3,"sources":["../../../../../src/@presentation/modules/auth/strategies/jwt.strategy.ts"],"sourcesContent":["import { env } from '@/@infra/config/env/env'\r\nimport { Injectable } from '@nestjs/common'\r\nimport { PassportStrategy } from '@nestjs/passport'\r\nimport { ExtractJwt, Strategy } from 'passport-jwt'\r\n\r\ninterface JwtPayload {\r\n  sub: string\r\n  role: string\r\n}\r\n\r\n@Injectable()\r\nexport class JwtStrategy extends PassportStrategy(Strategy) {\r\n  constructor() {\r\n    super({\r\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\r\n      ignoreExpiration: false,\r\n      secretOrKey: env.JWT_SECRET,\r\n    })\r\n  }\r\n\r\n  async validate(payload: JwtPayload) {\r\n    return new Promise<{ userId: string; role: string }>(resolve => {\r\n      resolve({ userId: payload.sub, role: payload.role })\r\n    })\r\n  }\r\n}\r\n"],"names":["JwtStrategy","PassportStrategy","Strategy","validate","payload","Promise","resolve","userId","sub","role","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","ignoreExpiration","secretOrKey","env","JWT_SECRET"],"mappings":";;;;+BAWaA;;;eAAAA;;;qBAXO;wBACO;0BACM;6BACI;;;;;;;;;;AAQ9B,IAAA,AAAMA,cAAN,MAAMA,oBAAoBC,IAAAA,0BAAgB,EAACC,qBAAQ;IASxD,MAAMC,SAASC,OAAmB,EAAE;QAClC,OAAO,IAAIC,QAA0CC,CAAAA;YACnDA,QAAQ;gBAAEC,QAAQH,QAAQI,GAAG;gBAAEC,MAAML,QAAQK,IAAI;YAAC;QACpD;IACF;IAZA,aAAc;QACZ,KAAK,CAAC;YACJC,gBAAgBC,uBAAU,CAACC,2BAA2B;YACtDC,kBAAkB;YAClBC,aAAaC,QAAG,CAACC,UAAU;QAC7B;IACF;AAOF"}