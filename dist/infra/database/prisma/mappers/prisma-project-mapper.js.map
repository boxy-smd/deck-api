{"version":3,"sources":["../../../../../src/infra/database/prisma/mappers/prisma-project-mapper.ts"],"sourcesContent":["import type { Prisma, Project as ProjectRaw } from '@prisma/client'\n\nimport { Project } from '@/domain/projects/enterprise/entities/project'\nimport type { ProjectStatus } from '@/domain/projects/enterprise/value-objects/project-status'\nimport { UniqueEntityID } from '@/shared/kernel/unique-entity-id'\n\n// biome-ignore lint/complexity/noStaticOnlyClass: This class is a mapper and should have only static methods\nexport class PrismaProjectMapper {\n  static toEntity(\n    raw: ProjectRaw & {\n      trails?: { id: string }[]\n      professors?: { id: string }[]\n    },\n  ): Project {\n    return Project.create(\n      {\n        title: raw.title,\n        description: raw.description,\n        content: raw.content ?? undefined,\n        semester: raw.semester,\n        publishedYear: raw.publishedYear,\n        status: raw.status as ProjectStatus,\n        allowComments: raw.allowComments,\n        bannerUrl: raw.bannerUrl ?? undefined,\n        authorId: UniqueEntityID.create(raw.authorId),\n        subjectId: raw.subjectId\n          ? UniqueEntityID.create(raw.subjectId)\n          : undefined,\n        trails: new Set(\n          (raw.trails ?? []).map(t => UniqueEntityID.create(t.id)),\n        ),\n        professors: new Set(\n          (raw.professors ?? []).map(p => UniqueEntityID.create(p.id)),\n        ),\n      },\n      UniqueEntityID.create(raw.id),\n    )\n  }\n\n  static toPrisma(project: Project): Prisma.ProjectCreateInput {\n    return {\n      id: project.id.toString(),\n      title: project.title,\n      description: project.description,\n      content: project.content,\n      semester: project.semester,\n      publishedYear: project.publishedYear,\n      status: project.status,\n      allowComments: project.allowComments,\n      bannerUrl: project.bannerUrl,\n      author: {\n        connect: { id: project.authorId.toString() }\n      },\n      subject: project.subjectId ? {\n        connect: { id: project.subjectId.toString() }\n      } : undefined,\n      trails: {\n        create: Array.from(project.trails).map(trailId => ({\n          trail: {\n            connect: { id: trailId.toString() }\n          }\n        })),\n      },\n      professors: {\n        create: Array.from(project.professors).map(professorId => ({\n          professor: {\n            connect: { id: professorId.toString() }\n          }\n        })),\n      },\n    }\n  }\n\n  static toEntityPost(raw: any): any {\n    const project = this.toEntity(raw)\n    return {\n      id: project.id.toString(),\n      title: project.title,\n      description: project.description,\n      content: project.content,\n      semester: project.semester,\n      publishedYear: project.publishedYear,\n      status: project.status,\n      allowComments: project.allowComments,\n      bannerUrl: project.bannerUrl,\n      authorId: project.authorId.toString(),\n      subjectId: project.subjectId?.toString(),\n      createdAt: project.createdAt,\n      updatedAt: project.updatedAt,\n      author: raw.author,\n      subject: raw.subject,\n      trails: raw.trails?.map((t: any) => t.trail) || [],\n      professors: raw.professors?.map((p: any) => p.professor) || [],\n    }\n  }\n\n  static toEntityDetails(raw: any): any {\n    const project = this.toEntity(raw)\n    return {\n      id: project.id.toString(),\n      title: project.title,\n      description: project.description,\n      content: project.content,\n      semester: project.semester,\n      publishedYear: project.publishedYear,\n      status: project.status,\n      allowComments: project.allowComments,\n      bannerUrl: project.bannerUrl,\n      authorId: project.authorId.toString(),\n      subjectId: project.subjectId?.toString(),\n      createdAt: project.createdAt,\n      updatedAt: project.updatedAt,\n      author: raw.author,\n      subject: raw.subject,\n      trails: raw.trails?.map((t: any) => t.trail) || [],\n      professors: raw.professors?.map((p: any) => p.professor) || [],\n      comments: raw.comments || [],\n    }\n  }\n}\n"],"names":["PrismaProjectMapper","toEntity","raw","Project","create","title","description","content","undefined","semester","publishedYear","status","allowComments","bannerUrl","authorId","UniqueEntityID","subjectId","trails","Set","map","t","id","professors","p","toPrisma","project","toString","author","connect","subject","Array","from","trailId","trail","professorId","professor","toEntityPost","createdAt","updatedAt","toEntityDetails","comments"],"mappings":"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"}