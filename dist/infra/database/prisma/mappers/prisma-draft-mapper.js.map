{"version":3,"sources":["../../../../../src/infra/database/prisma/mappers/prisma-draft-mapper.ts"],"sourcesContent":["import type { Draft as DraftRaw, Prisma } from '@prisma/client'\n\nimport { Project } from '@/domain/projects/enterprise/entities/project'\nimport { ProjectStatus } from '@/domain/projects/enterprise/value-objects/project-status'\nimport { UniqueEntityID } from '@/shared/kernel/unique-entity-id'\n\n// biome-ignore lint/complexity/noStaticOnlyClass: This class is a mapper and should have only static methods\nexport class PrismaDraftMapper {\n  static toEntity(\n    raw: DraftRaw & {\n      trails: { id: string; name: string }[]\n      professors: { id: string; name: string }[]\n    },\n  ): Project {\n    return Project.create(\n      {\n        title: raw.title,\n        description: raw.description ?? undefined,\n        content: raw.content ?? undefined,\n        semester: raw.semester ?? undefined,\n        publishedYear: raw.publishedYear ?? undefined,\n        allowComments: raw.allowComments ?? true,\n        bannerUrl: raw.bannerUrl ?? undefined,\n        status: ProjectStatus.DRAFT,\n        authorId: UniqueEntityID.create(raw.authorId),\n        subjectId: raw.subjectId\n          ? UniqueEntityID.create(raw.subjectId)\n          : undefined,\n        trails: new Set(\n          raw.trails.map(trail => UniqueEntityID.create(trail.id)),\n        ),\n        professors: new Set(\n          raw.professors.map(professor => UniqueEntityID.create(professor.id)),\n        ),\n      },\n      UniqueEntityID.create(raw.id),\n    )\n  }\n\n  static toPrisma(draft: Project): Prisma.DraftUncheckedCreateInput {\n    return {\n      id: draft.id.toString(),\n      title: draft.title,\n      description: draft.description,\n      content: draft.content ?? undefined,\n      semester: draft.semester,\n      publishedYear: draft.publishedYear,\n      allowComments: draft.allowComments,\n      bannerUrl: draft.bannerUrl ?? undefined,\n      createdAt: draft.createdAt,\n      updatedAt: draft.updatedAt ?? undefined,\n      authorId: draft.authorId.toString(),\n      trails: {\n        connect: Array.from(draft.trails).map(trailId => ({\n          id: trailId.toString(),\n        })),\n      },\n      subjectId: draft.subjectId?.toString(),\n      professors: {\n        connect: Array.from(draft.professors).map(professorId => ({\n          id: professorId.toString(),\n        })),\n      },\n    }\n  }\n\n  static toPrismaUpdate(draft: Project): Prisma.DraftUncheckedUpdateInput {\n    return {\n      title: draft.title,\n      description: draft.description,\n      content: draft.content ?? undefined,\n      semester: draft.semester,\n      publishedYear: draft.publishedYear,\n      allowComments: draft.allowComments,\n      bannerUrl: draft.bannerUrl ?? undefined,\n      updatedAt: draft.updatedAt,\n      authorId: draft.authorId.toString(),\n      trails: {\n        set: Array.from(draft.trails).map(trailId => ({\n          id: trailId.toString(),\n        })),\n      },\n      subjectId: draft.subjectId?.toString(),\n      professors: {\n        set: Array.from(draft.professors).map(professorId => ({\n          id: professorId.toString(),\n        })),\n      },\n    }\n  }\n}\n"],"names":["PrismaDraftMapper","toEntity","raw","Project","create","title","description","undefined","content","semester","publishedYear","allowComments","bannerUrl","status","ProjectStatus","DRAFT","authorId","UniqueEntityID","subjectId","trails","Set","map","trail","id","professors","professor","toPrisma","draft","toString","createdAt","updatedAt","connect","Array","from","trailId","professorId","toPrismaUpdate","set"],"mappings":";;;;+BAOaA;;;eAAAA;;;yBALW;+BACM;gCACC;AAGxB,IAAA,AAAMA,oBAAN,MAAMA;IACX,OAAOC,SACLC,GAGC,EACQ;QACT,OAAOC,gBAAO,CAACC,MAAM,CACnB;YACEC,OAAOH,IAAIG,KAAK;YAChBC,aAAaJ,IAAII,WAAW,IAAIC;YAChCC,SAASN,IAAIM,OAAO,IAAID;YACxBE,UAAUP,IAAIO,QAAQ,IAAIF;YAC1BG,eAAeR,IAAIQ,aAAa,IAAIH;YACpCI,eAAeT,IAAIS,aAAa,IAAI;YACpCC,WAAWV,IAAIU,SAAS,IAAIL;YAC5BM,QAAQC,4BAAa,CAACC,KAAK;YAC3BC,UAAUC,8BAAc,CAACb,MAAM,CAACF,IAAIc,QAAQ;YAC5CE,WAAWhB,IAAIgB,SAAS,GACpBD,8BAAc,CAACb,MAAM,CAACF,IAAIgB,SAAS,IACnCX;YACJY,QAAQ,IAAIC,IACVlB,IAAIiB,MAAM,CAACE,GAAG,CAACC,CAAAA,QAASL,8BAAc,CAACb,MAAM,CAACkB,MAAMC,EAAE;YAExDC,YAAY,IAAIJ,IACdlB,IAAIsB,UAAU,CAACH,GAAG,CAACI,CAAAA,YAAaR,8BAAc,CAACb,MAAM,CAACqB,UAAUF,EAAE;QAEtE,GACAN,8BAAc,CAACb,MAAM,CAACF,IAAIqB,EAAE;IAEhC;IAEA,OAAOG,SAASC,KAAc,EAAoC;QAChE,OAAO;YACLJ,IAAII,MAAMJ,EAAE,CAACK,QAAQ;YACrBvB,OAAOsB,MAAMtB,KAAK;YAClBC,aAAaqB,MAAMrB,WAAW;YAC9BE,SAASmB,MAAMnB,OAAO,IAAID;YAC1BE,UAAUkB,MAAMlB,QAAQ;YACxBC,eAAeiB,MAAMjB,aAAa;YAClCC,eAAegB,MAAMhB,aAAa;YAClCC,WAAWe,MAAMf,SAAS,IAAIL;YAC9BsB,WAAWF,MAAME,SAAS;YAC1BC,WAAWH,MAAMG,SAAS,IAAIvB;YAC9BS,UAAUW,MAAMX,QAAQ,CAACY,QAAQ;YACjCT,QAAQ;gBACNY,SAASC,MAAMC,IAAI,CAACN,MAAMR,MAAM,EAAEE,GAAG,CAACa,CAAAA,UAAY,CAAA;wBAChDX,IAAIW,QAAQN,QAAQ;oBACtB,CAAA;YACF;YACAV,WAAWS,MAAMT,SAAS,EAAEU;YAC5BJ,YAAY;gBACVO,SAASC,MAAMC,IAAI,CAACN,MAAMH,UAAU,EAAEH,GAAG,CAACc,CAAAA,cAAgB,CAAA;wBACxDZ,IAAIY,YAAYP,QAAQ;oBAC1B,CAAA;YACF;QACF;IACF;IAEA,OAAOQ,eAAeT,KAAc,EAAoC;QACtE,OAAO;YACLtB,OAAOsB,MAAMtB,KAAK;YAClBC,aAAaqB,MAAMrB,WAAW;YAC9BE,SAASmB,MAAMnB,OAAO,IAAID;YAC1BE,UAAUkB,MAAMlB,QAAQ;YACxBC,eAAeiB,MAAMjB,aAAa;YAClCC,eAAegB,MAAMhB,aAAa;YAClCC,WAAWe,MAAMf,SAAS,IAAIL;YAC9BuB,WAAWH,MAAMG,SAAS;YAC1Bd,UAAUW,MAAMX,QAAQ,CAACY,QAAQ;YACjCT,QAAQ;gBACNkB,KAAKL,MAAMC,IAAI,CAACN,MAAMR,MAAM,EAAEE,GAAG,CAACa,CAAAA,UAAY,CAAA;wBAC5CX,IAAIW,QAAQN,QAAQ;oBACtB,CAAA;YACF;YACAV,WAAWS,MAAMT,SAAS,EAAEU;YAC5BJ,YAAY;gBACVa,KAAKL,MAAMC,IAAI,CAACN,MAAMH,UAAU,EAAEH,GAAG,CAACc,CAAAA,cAAgB,CAAA;wBACpDZ,IAAIY,YAAYP,QAAQ;oBAC1B,CAAA;YACF;QACF;IACF;AACF"}